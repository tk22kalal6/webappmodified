<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>anesthesia pyq - Combined Tests</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
</style>
  <style>
  body {
    font-family: Arial, sans-serif;
    padding: 0;
    margin: 0;
  }

  button {
    margin: 5px;
    padding: 10px 15px;
    background: #ffffff;
    border: 1px solid #2d3748;
    border-radius: 4px;
    cursor: pointer;
    color: #000000;
    position: relative;
    top: 5px;
    font-size: 14px;
    transition: background 0.2s ease, color 0.2s ease, transform 0.1s ease;
  }

  button:hover {
    background: #f3f4f6;
    color: #000000;
    transform: translateY(-1px);
  }

  body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
        .iframe-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: auto;
            -webkit-overflow-scrolling: touch;
        }
        .iframe-container iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
    
    /* Mobile optimization */
    

  /* Dropdown styling */
  .dropdown-wrapper {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 1100;
  }

  .dropdown-toggle {
    background: #2c5281;
    color: white;
    border: none;
    font-size: 14px;
    padding: 10px 18px;
    border-radius: 6px;
    font-weight: bold;
    letter-spacing: 0.5px;
  }

  .dropdown-toggle:hover {
    background: #24466c;
  }

  .dropdown-menu {
  display: none;
  position: absolute;
  right: 0;              /* keep aligned to right edge of toggle */
  margin-top: 6px;
  background: white;
  border: 1px solid #cbd5e0;
  border-radius: 8px;
  max-height: 350px;
  overflow-y: auto;
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
  min-width: 250px;
  max-width: 90vw;       /* prevent it from going outside screen */
  word-wrap: break-word; /* wrap long names */
  white-space: normal;   /* allow text to wrap */
  animation: fadeIn 0.2s ease-in-out;
}

.dropdown-menu button {
  display: block;
  width: 100%;
  text-align: left;
  margin: 0;
  padding: 10px 15px;
  border-radius: 0;
  background: transparent;
  color: #2d3748;
  border: none;
  border-bottom: 1px solid #edf2f7;
  font-size: 13px;
  white-space: normal;   /* allow wrapping inside button */
  word-break: break-word;
}


  img {
    max-width: 100%;
    max-height: 400px;
    width: auto;
    height: auto;
    display: block;
    margin: 10px auto;
  }

  body > section:last-child {
    margin-bottom: 0 !important;
  }
  
</style>
  <script>
  function showTest(id) {
    document.querySelectorAll('.iframe-container').forEach(div => div.style.display = 'none');
    document.getElementById(id).style.display = 'block';
    document.getElementById('dropdownMenu').style.display = 'none';
    window.scrollTo(0, 0);
  }

  function toggleDropdown() {
    const menu = document.getElementById('dropdownMenu');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
  }

  document.addEventListener('click', function (event) {
    const toggle = document.getElementById('dropdownToggle');
    const menu = document.getElementById('dropdownMenu');
    if (!toggle.contains(event.target) && !menu.contains(event.target)) {
      menu.style.display = 'none';
    }
  });
</script>
<script src="../../../access-control.js"></script>
  <script src="../../../block.js"></script>
  <script src="../../../error-handler/link-checker.js"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5920367457745298"
     crossorigin="anonymous"></script>
</head>
<body>
<script>
      // Initialize access control for protected page
      if (!accessControl.initProtectedPage()) {
        throw new Error('Access denied - redirecting to index.html');
      }
    </script>
  <button onclick="history.back()" style="position: absolute; top: 20px; left: 20px; background: transparent; color: white; border: none; padding: 10px; cursor: pointer; z-index: 1001; font-size: 20px;">
  <i class="fas fa-arrow-left"></i>
</button>

<div class="dropdown-wrapper">
  <button class="dropdown-toggle" id="dropdownToggle" onclick="toggleDropdown()">☰ INDEX</button>
  <div class="dropdown-menu" id="dropdownMenu">
<button onclick="showTest('test1')">ANAESTHESIA-(INICET NOV 2024)</button>
<button onclick="showTest('test2')">Anesthesia - AIIMS JUNE 2020</button>
<button onclick="showTest('test3')">Anesthesia - AIIMS MAY 2018</button>
<button onclick="showTest('test4')">Anesthesia - AIIMS MAY 2019</button>
<button onclick="showTest('test5')">Anesthesia - AIIMS NOV 2018</button>
<button onclick="showTest('test6')">Anesthesia - AIIMS NOV 2019</button>
<button onclick="showTest('test7')">Anesthesia - INI CET JULY 2021</button>
<button onclick="showTest('test8')">Anesthesia - INI CET MAY 2022</button>
<button onclick="showTest('test9')">Anesthesia - INI CET MAY 2023</button>
<button onclick="showTest('test10')">Anesthesia - INI CET NOV 2020</button>
<button onclick="showTest('test11')">Anesthesia - INI CET NOV 2021</button>
<button onclick="showTest('test12')">Anesthesia - INI CET NOV 2022 (PART A)</button>
<button onclick="showTest('test13')">Anesthesia - INI CET NOV 2022 (PART B)</button>
<button onclick="showTest('test14')">Anesthesia - INI CET NOV 2023</button>
<button onclick="showTest('test15')">Anesthesia - INICET MAY 2024</button>
<button onclick="showTest('test16')">Anesthesia - NEET PG 2018</button>
<button onclick="showTest('test17')">Anesthesia - NEET PG 2019</button>
<button onclick="showTest('test18')">Anesthesia - NEET PG 2020</button>
<button onclick="showTest('test19')">Anesthesia - NEET PG 2021</button>
<button onclick="showTest('test20')">Anesthesia - NEET PG 2022</button>
<button onclick="showTest('test21')">Anesthesia - NEET PG 2023</button>
<button onclick="showTest('test22')">Anesthesia - NEET PG 2024</button>
</div>
  </div>
  
<div id="test1" class="iframe-container" style="display:block;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;ANAESTHESIA-(INICET NOV 2024)&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;ANAESTHESIA-(INICET NOV 2024)&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                6 Questions | 6 Total Marks | 16 min Duration | ~160.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Jackson Rees circuit is used for?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Pediatric anaesthesia&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Cardiac anaesthesia&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Neuro anaesthesia&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Obstetric anaesthesia&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Pediatric anaesthesia&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Pediatric anaesthesia The Mapleson F circuit is known as the “Jackson-Rees” and is used for paediatric anaesthesia. Mapleson described and analyzed five different breathing circuits, designated A through E. The Mapleson A, B, and C systems are rarely used today, but the D, E, and F systems are com­monly used.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Mapleson systems with respect to prevention of rebreathing are : A &amp;gt; DFE &amp;gt; CB during spontaneous ventilation, and DFE &amp;gt; BC &amp;gt; A during controlled ventilation.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: B, C, D. Most commonly used circuit in adults are Mapelson A ( for spontaneous ) and Mapelson D ( for controlled) circuit.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Table:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;#MANTRA Mapelson A : Magill’s Coxial, Lacks Circuit Mapelson D : Bain’s Circuit Mapelson C : Ambu Bag ( Corrugated Tube) Mapelson E : Ayre’s T Tube Mapelson F : Jackson-Rees&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A female following an RTA injured her chest. On X-ray, fracture of 3rd to 5th ribs was noted. Pain was not responsive to analgesics. Which block will be given to reduce the pain?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Cervical block&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Thoracic epidural block&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Supra-clavicular block&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Lumbar epidural block&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Thoracic epidural block&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1736330950561-QT118IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Thoracic epidural block When sensory blockade of high thoracic dermatomes is required, the most reliable approach is a thoracic epidural block.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Thoracic epidural blocks are indicated for major operations requiring long-lasting pain relief, or when adequate pain relief is not achieved by analgesics, thus requiring placement of an epidural cath­eter to allow repeat injections or continuous infusion of local anesthetic.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: A. Cervical block : the technique can be contemplated for patients with chronic pain or to prevent phantom limb pain before an amputa­tion of the upper arm at the scapular level. Option: C. Supraclavicular block : The goal of the supraclavicular technique is to see the spread of local anesthetic reaching the angle between the first rib and the subclavian artery. Indications for supraclavicular blocks include operations on the elbow, forearm, and hand. Blockade occurs at the distal trunk–proximal division level of the brachial plexus. Option: D. Lumbar epidural analgesia offers a safe and effective method of pain relief during labor and is the mainstay of labor anal­gesia. Epidural analgesia is most commonly initiated after placement of a catheter into the epidural space between L2-3 and L4-5. The lumbar plexus lies in the psoas compartment between the psoas major and quadratus lumborum muscles. Lumbar epidural anesthesia by loss-of-resistance technique with saline. Anatomic landmarks and method of needle placement for a superficial cervical plexus block. Ultrasound image of the brachial plexus at the level of the first rib.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following drug causes adrenal suppression?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Thiopental&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Ketamine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Etomidate&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Propofol&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Etomidate&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Etomidate Etomidate causes adrenocortical suppression (first seen In 1983 by Ledingham and Watt and later confirmed by investigation) . Due to adrenocortical suppression it may cause shock-like symptoms.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The specific endocrine effects manifested by etomi­date are a dose-dependent reversible inhibition of the enzyme 11β-hydroxylase, which results in decreased biosynthesis of cortisol. The blockade of the cytochrome P450-dependent enzyme 11β-hydroxylase also results in decreased mineralocorticoid production and an increased formation of intermediaries (11-deoxycorticosterone).&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Option: A. Thiopental : doesn’t cause adrenal suppression. The side effects of injecting barbiturates include a garlic or onion taste, allergic reactions, local tis­sue irritation, and rarely, tissue necrosis. Option: B. Ketamine : it doesn’t cause adrenal suppression. Ketamine has a propensity to cause hypertension and tachycardia . Option: D. Propofol after a single dose or a prolonged infusion does not affect corticosteroid synthesis or alter the normal response to adrenocorticotropic hormone (ACTH) stimulation.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Table:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;#MANTRA Iv Anaesthetic Agent Side Effect Propofol Infusion Syndrome, Painful Injection ( Soyabean Oil, Egg Lecithin) Ketamine C/I In Hypertension, Epilepsy, Glaucoma ( Increase Bp, IOP, Icp) Etomidate Adrenal Suppression Thiopentone Intra-Arterial Vasospasm&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following is incorrect regarding thiopentone?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;It is lipid soluble&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;It achieves maximum concentration in the brain after an IV infusion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Redistribution to adipose tissue and muscle is seen&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Rapid decline in its effect is due to renal excretion&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Rapid decline in its effect is due to renal excretion&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Rapid decline in its effect is due to renal excretion The barbiturates (with the exception of phenobarbital) are metabolized hepatically.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Hepatic metabolism accounts for the elimination of all of the barbiturates with the excep­tion of phenobarbital. The alkalinization of urine with bicarbonate enhances the renal excretion of phenobarbital. Other barbiturates are excreted unchanged by the kidney only in trivial amounts.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Option: A. It is lipid soluble. Because of its lipophilicity , relatively large volume of dis­tribution, and low rate of hepatic clearance, thiopental can accumulate in tissues, especially if given in large doses over a prolonged period. Option: B. It achieves maximum concentration in the brain after an IV infusion. Drugs with high lipid solubility and a low degree of ioniza­tion cross the blood-brain barrier rapidly, producing a fast onset of action. Approximately 50% of thiopental is nonionized at physiologic pH, which accounts partly for the rapid accumulation of thiopental in the cerebrospinal fluid (CSF) after IV administration. Option: C. Adipose tissue uptake and metabolic clearance (elimination) play only a minor role in the termination of the effects of the induction dose. This is a result of the minimal perfusion ratio of adipose tissue compared with other tissues and the slow rate of removal.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following must be avoided in post cardiac arrest resuscitation care?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Maintain MAP over 65&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Maintain SpO2 above 94%&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Revascularization procedure if patient develops ST elevation post resuscitation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Bring the body temperature down to below 32 degrees, therapeutic hypothermia if unresponsive&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Bring the body temperature down to below 32 degrees, therapeutic hypothermia if unresponsive&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Bring the body temperature down to below 32 degrees, therapeutic hypothermia if unresponsive A target temperature between 32°C and 36°C is recommended for at least 24 hours.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;By limiting the metabolic demand and decreas­ing the utilization of oxygen and glucose, targeted tem­perature management (TTM) reduces the risk of energy depletion, preserving the ion channel’s integrity and decreasing the intracellular calcium influx that can trig­ger neuronal apoptotic pathways. A target temperature between 32°C and 36°C is recommended for at least 24 hours. It is also recommended to continue to monitor the tempera­ture and maintain normothermia (treat fever) beyond this window. Prognostication should not occur until 72 hours after ROSC, or if TTM is provided, 72 hours after completion of TTM.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Option: A. Maintain MAP over 65 Option: B. Maintain SpO2 above 94%. Post–cardiac arrest patients are at increased risk for developing ARDS. Some of the contributing factors include aspiration pneumonia, pulmonary contusions after aggres­sive CPR, ventilator-associated lung injury, and the pulmo­nary manifestations of the post–cardiac arrest syndrome. The optimal mechanical ventilation strategy after cardiac arrest has, nevertheless, not been well defined. Option: C. Urgent coronary angiography with prompt recana­lization of any infarct-related artery is crucially important to improving the patient’s survival, enhancing neurologic outcome, and preventing recurrence of arrest.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Table:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;#MANTRA Post resuscitation syndrome is a complex pathophysiologic condition characterized by myocardial dysfunction, neurologic injury, and systemic perturbations associated with the reperfusion of the ischemic tissue. Post–cardiac arrest care must therefore incorporate measures to mini­mize the systemic ischemic-reperfusion response, improve myocardial function, and prevent post resuscitation brain injury and other systemic complications.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Ambu aura 40 is an example of?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Supraglottic laryngeal airway generation 1&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Supraglottic laryngeal airway generation 2&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Supraglottic laryngeal airway generation 3&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Supraglottic laryngeal airway generation 4&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Supraglottic laryngeal airway generation 1&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1736330947514-QT188IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Supraglottic laryngeal airway generation 1 Ambu aura40 is an example of Supraglottic laryngeal airway generation 1&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The Ambu Aura40™ is a reusable laryngeal mask airway with a fixed curve that accurately replicates the natural human anatomy of the upper airway. Figure : ProSeal LMA TM Figure: Ambu Aura40™ Supraglottic airway devices. Left to right, the devices are (A) classic laryngeal mask airway (LMA); (B) Intubating LMA; (C) Flexible LMA: (D) ProSeal LMA; (E) LMA Supreme, (F) LMA Protector.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Example of a first generation SGA is the classic laryngeal mask design, today available as the LMA Unique® and LMA Classic® . Second generation SGAs are defined as \&quot;those with specific design features intended to reduced the risk of aspiration\&quot;, making these devices &#x27;safer&#x27; than first generation ones. Cook’s classification Classification Introduction Examples 1st Gen SAD [ 14 , 20 , 21 , 31 , 43 , 65 ] ●       Simple breathing tube, usually with some form of mask or opening at the larynx. ●       Classic LMA, LMA-Unique, CobraPLA, laryngeal tube airway 2nd Gen SAD [ 22 , 26 , 27 , 35 , 48 ] ●       Features of 1st generation plus provision for gastric drainage and improved protection against aspiration. ●       Combitube, LMA ProSeal, LMA Supreme, I-gel 3rd Gen SAD [ 19 ] ●       Features of 2nd generation plus Incorporates dynamic sealing mechanism. ●       Baska&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 16 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test2" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - AIIMS JUNE 2020&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - AIIMS JUNE 2020&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                1 Questions | 1 Total Marks | 11 min Duration | ~660.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Chest trauma patient, which is not the initial ventilator setting:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;FiO2 = 60%&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Tidal volume 10-15 ml /kg&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;PEEP 0-5 cm H2O&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Inspiratory flow 60-100 liter&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Tidal volume 10-15 ml /kg&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Tidal volume 10-15 ml /kg One of the most important components of lung protective strategy is th e low tidal volume of 4-6 ml/kg.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Lung protective strategy is meant to prevent barotrauma therefore other components of lung protective strategy are: Plateau pressure less than 30 cmH20. Starting PEEP of 0- 5 cmH20 and then titrate based on pO2 and plateau pressure.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- One more component of lung protective strategy is to prevent oxygen-related toxicity, therefore, FIO2 should be kept below 60%. Option C- As PPEP can cause barotrauma, therefore, minimum PEEP should be used. Option D - A flow of 60-70 liter is optimal for the majority of the patients.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Inspiratory flow is the velocity with which the breathing gas is supplied to the patient. If the inspiratory flow is less than the patient demand then the patient will try to increase his inspiratory effort and this will increase the work of breathing which is not desirable. If the inspiratory flow is high there will be increased airway pressure which can cause barotrauma and increase dead space which is again not desirable. Therefore, a flow of 60-70 liters/minute is adequate (in COPD patients a higher flow rate of 80-100 liters/min is required to increase the expiratory time). Modern-day ventilators automatically adjust the flows based on patient demands.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 11 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test3" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - AIIMS MAY 2018&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - AIIMS MAY 2018&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                7 Questions | 7 Total Marks | 17 min Duration | ~145.71 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;A patient is undergoing MRND for laryngeal malignancy; while dissecting the venous tributaries the surgeon elevated the internal jugular vein for ligation. Suddenly the patients EtCO2 dropped from 38 mmHg to 12 mmHg and the patient developed hypotension along with cardiac arrhythmia. Which of the following is most likely cause?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Sympathetic overactivity&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Vagal stimulation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Venous air embolism&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Carotid body stimulati&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Venous air embolism&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Venous air embolism Diagnosis Standard of care is precordial Doppler (left or right parasternal, between 2nd and 3rd ribs) + ETCO 2 monitoring although this is not the most sensitive test TEE is most sensitive. Pulmonary artery pressure will rise, and CO 2 will fall after VAE. Sensitivity of modalities for VAE detection Doppler (left or right parasternal, between 2nd and 3rd rib, mill wheel TEE (most sensitive) murmur) ETCO 2 and/or PA pressure Cardiac output and/or CVP Blood pressure, EKG (RV strain pattern, ST depression), stethoscope (least sensitive) Treatment Notify surgeon to flood/pack surgical field, jugular compression, lower head, aspirate RA-Cath, 100% FiO 2 , pressers.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;What is the correct order of suctioning during neonatal resuscitation?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Mouth nose&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Mouth nose trachea&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Nose mouth&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Trachea nose mouth&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Mouth nose&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Mouth nose As per NRP 2016, the initial steps of neonatal resuscitation should be completed within one minute of the birth of the baby. In a baby with delayed transition (Poor tone or no cry), the initial steps of resuscitation are Warmth Position the neck to open the airway Clear secretions from airway (if needed) Dry Stimulate Warmth Place baby in warmer, maintain temperature between 36.5–37.5°C. Position to open airway Position the baby in supine with head and neck neutral or extended in “sniffing the air position” using a shoulder roll under shoulder blades to open the airway, avoid hyperextension and flexion of neck. Clearing the   secretions Clear secretions from airway only if the baby is gasping and has a poor tone. A gentle suction is done in mouth before the nose to ensure that there is nothing for the newborn to aspirate even if he gasps when nose is suctioned. Remember M comes before N. Dry Wet skin increases evaporative loss, so dry the baby gently if there is any fluid and discard the first towel. Stimulation If the respiration is not adequate with the above steps, a brief tactile stimulation by gently rubbing back, trunk or extremities should be tried before initiating positive pressure ventilation (PPV).&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A Patient brought to emergency department was intubated, opens eyes to pain and shows abnormal flexion. What is the GCS score?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;E2VNTM3&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;E2VTM3&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;E2VIM3&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;E2VTM4&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. E2VNTM3&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;E2VNTM3 The Glasgow Coma Scale (GCS) is a widely used scoring system with good repeatability (note: the scale is used to assess level of consciousness and is not designed for following neurologic deficits). General practice is to record a “T” (for “intubated”) next to the verbal score and the total score for patients whose verbal axis cannot be assessed because of intubation. No single GCS score defines a cutoff for coma, however, 90% of patients with GCS ≤8 and none with GCS ≥9 meet the above definition of coma. Thus, GCS ≤8 is a generally accepted operational definition of coma. Glasgow coma scale 1 (recommended for age &amp;gt;4 years) Points Best eye opening Best verbal Best motor 6 – – Obeys 5 – Oriented Localizes pain 4 Spontaneous Confused Withdraws to pain 3 To speech Inappropriate Flexion (decorticate) 2 To pain Incomprehensible Extensor (decerebrate) 1 None None None Technically, this is a scale of impaired consciousness, whereas “coma” implies unresponsiveness Range of total points: 3 (worst) to 15 (normal) When testing eye opening to pain, use peripheral stimulus (the grimace associated with central pain may cause eye closure) If no motor response, important to exclude, spinal cord transaction Mild disability (13–15): Moderate disability (9–12): Loss of consciousness greater than 30 minutes Physical or cognitive impairments which may or may not resolve Benefit from rehabilitation Severe disability (3–8): Coma: unconscious state. 0 meaningful response, no voluntary activities Vegetative state (less than 3): Sleep wake cycles Arousal, but no interaction with environment No localized response to pain Persistent vegetative state: Vegetative state lasting longer than one month Brain death: No brain functions Specific criteria needed for making this diagnosis&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;All of the following are definitive airway except:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Nasotracheal tube&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Orotracheal tube&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;LMA&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Tracheostomy&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. LMA&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;LMA Laryngeal mask airway is a supraglottic device (lies above glottis) therefore is not considered a definitive airway. LMA Indications: LMA is commonly used during general anesthesia for various surgical procedures. It is useful in situations where intubation is not feasible or is not required, such as in spontaneously breathing patients. Advantages of LMA: It is easier and quicker to insert compared to endotracheal intubation. It can be used in patients with a potentially difficult airway. It causes less trauma to the airway and vocal cords. Disadvantages and Limitations: The LMA may not provide as secure an airway as endotracheal intubation, particularly for longer surgical procedures. It is not suitable for patients with a risk of regurgitation and aspiration (e.g., patients with full stomachs). It is not suitable for patients who require positive-pressure ventilation at high pressures.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A, B, D- Definite airway means ventilating the patient with a tube in trachea which may be endotracheal tube (oral or nasal) or tracheostomy tube.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Dissociative anesthesia is produced by:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Ketamine&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Propofol&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Etomidate&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Thiopentone&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Ketamine&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ketamine Ketamine inhibits the cortex to produce unconsciousness, inhibits the thalamus to produce analgesia, and simultaneously stimulates the limbic system to produce hallucinations and emergence reactions. This causes the patient not only to be dissociated from surroundings he/she gets dissociated from himself or herself. Ketamine indication in various medical condition: Ketamine Indication Description Anesthesia and Sedation Used as an anesthetic agent for surgical procedures, particularly in cases where rapid induction and emergence are required. - It&#x27;s used in emergency and trauma settings for procedural sedation (e.g., reduction of dislocated joints). Analgesia Ketamine is employed for pain management, especially in situations where traditional pain relief methods are insufficient or contraindicated. - It&#x27;s used for acute and chronic pain conditions, such as complex regional pain syndrome (CRPS) and neuropathic pain. Depression and Mood Disorders Ketamine has shown promise in the treatment of treatment-resistant depression (TRD) and major depressive disorder (MDD) in some individuals.Administered intravenously as part of ketamine-assisted psychotherapy. Post-Traumatic Stress Disorder (PTSD) Investigational use of ketamine in combination with psychotherapy for individuals with PTSD. Acute Agitation and Excited Delirium Used in emergency medicine to manage severe agitation and excited delirium, particularly in cases involving synthetic cathinones (\&quot;bath salts\&quot;) or stimulant overdose. Induction of General Anesthesia in Pediatrics Ketamine is often used for the induction of anesthesia in pediatric patients due to its safety profile and minimal impact on respiratory function. Bronchodilation In certain cases of severe asthma or bronchospasm not responding to standard treatment, ketamine may be used to provide bronchodilation and improve airflow. Intracranial Hypertension Ketamine&#x27;s cerebral vasodilatory effect can be useful in managing intracranial hypertension, such as in traumatic brain injury (TBI) or increased intracranial pressure (ICP).&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Options: B, C, and D. Propofol, Etomidate, and thiopentone only cause loss of consciousness by inhibiting cortex . They do not cause stimulation of the limbic system, which means they do not produce the dissociative state.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;What is the correct procedure of inserting Ryle’s tube:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Supine with flexed neck&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Sitting with extended neck&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Supine with extended neck&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Sitting with flexed neck&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Sitting with flexed neck&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578346784-QTDTPYQ108IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sitting with flexed neck For patients who are awake, alert and cooperative fowler position is helpful with a 90° angle preferred. A chair may be used but a stretcher or bed may provide better patient comfort. The patient’s neck should be slightly flexed to avoid endo tracheal placement. Semi-Fowler’s position: Fowler’s position&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;The arrow in the following image is placed at:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Just above the esophagus&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Just above the epiglottis&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;In aryepiglottic fold&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;In middle of hypopharynx&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Just above the esophagus&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578346755-QTDTPYQ002IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Just above the esophagus The image is of Proseal LMA which is the prototype of second generation LMA. One of the major advantages of second generation LMA is they have separate tube for gastric deflation. Suction tube is passed through this tube, which through the hole (shown by arrow in image) enters the esophagus to deflate the stomach. Therefore, this hole should lie just above the esophagus. Indications: The ProSeal LMA is indicated for use in anesthesia and airway management during surgical procedures, particularly when a higher seal pressure and gastric protection are required. Advantages of the ProSeal LMA: Enhanced seal pressure compared to the classic LMA, making it suitable for positive-pressure ventilation at higher pressures. Passive gastric drainage to reduce the risk of aspiration. Reduced risk of air leakage around the cuff , providing better control of ventilation. Suitable for a wide range of surgical and diagnostic procedure s, including laparoscopic surgery. Disadvantages and Limitations: The ProSeal LMA may require more skill and experience for proper insertion compared to the classic LMA. It may not be suitable for patients with anatomical variatio ns or those who require a very small-sized airway device . Proper positioning and cuff inflation are critical to prevent complications.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option B, C, D- If the hole for gastric deflation is at any position other than just above the esophagus, the gastric deflation will not be possible defying the purpose of second generation LMA.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 17 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test4" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - AIIMS MAY 2019&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - AIIMS MAY 2019&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                2 Questions | 2 Total Marks | 12 min Duration | ~360.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Which is not an obvious advantage of a high-pressure oxygen delivery system?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Humidification is preserved&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Can deliver higher concentration as compared to nasal cannula&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Decreases the need for intubation&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Accurate in delivery&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Decreases the need for intubation&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Decreases the need for intubation Compared to Non-invasive ventilation HFNC had not been able to show any benefit of avoiding intubation however when compared to simple oxygen delivery devices like nasal cannula or oxygen mask it has been found to decrease the need for intubation. Most often it is compared to NIV.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- HFNC delivers humidified oxygen and it is necessary to deliver humidified oxygen otherwise dry oxygen with such high flows will inhibit ciliary activity. Option B- It is possible to deliver 100% oxygen with high-flow nasal cannula while with nasal cannula maximum oxygen delivered is 44%. Option D- They are accurate in terms of oxygen delivery.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Duration of action of Proparacaine:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;2 min&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;5 min&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;10 min&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;20 min&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. 20 min&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;20 min Proparacaine is only available as drops used for topical analgesia in ophthalmology. It is an amino ester. Duration of action is 15-20 minutes Indications: Proparacaine is primarily used in ophthalmology for procedures such as tonometry (measuring intraocular pressure), foreign body removal from the eye, and other diagnostic or therapeutic eye examinations. It is commonly used before procedures like cataract surgery to provide temporary anesthesia. Formulation: Proparacaine is available as eye drops and is typically administered directly onto the surface of the eye. Mode of Action: Proparacaine belongs to the class of medications known as local anesthetics. It works by blocking sodium channels in nerve cell membranes, preventing the transmission of pain signals. The numbing effect occurs rapidly, usually within seconds of administration, and lasts for a short duration, typically around 15-20 minutes.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 12 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test5" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - AIIMS NOV 2018&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - AIIMS NOV 2018&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                2 Questions | 2 Total Marks | 12 min Duration | ~360.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Which of the following statements is correct regarding the difference between adult and child resuscitation?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Ventricular dysrhythmias are uncommon in children&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Infant myocardium more refractory to hypoxia because of congenital heart disease&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;More ventilation to be given compared to chest compression&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Dissolved aortic oxygen concentration is more in Pre attack state&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Ventricular dysrhythmias are uncommon in children&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ventricular dysrhythmias are uncommon in children Ventricular dysrhythmias are not a common cause of cardiac arrest in children. Hypoxia-induced bradycardia is more important cause and that is why rescue breaths are more important in pediatric resuscitation. The ratio of ventilation to compression in an infant is 3:1 and in children with 2 rescuers is 15:2. The reason we give more ventilation in children is because most of the cardiac arrest in pediatric age group is due to respiratory failure and not due to primary cardiac event. So more ventilation has better outcome.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Technique for Ryle’s tube insertion:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Supine with neck flexed&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Sitting with neck flexed&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Supine with neck extended&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Sitting with neck extended&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Sitting with neck flexed&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sitting with neck flexed For NG tube Ideal position is sitting with neck flexed (if conscious) In comatose patients—Supine with neck flexed Supine with neck extended is ideal for ET intubation. Equipment Needed: Ryle&#x27;s tube (nasogastric tube) Water-soluble lubricant Adhesive tape A syringe (usually 50 mL) A stethoscope A cup of water or a glass of water with a straw for the patient Procedure: Prepare the Patien t: Explain the procedure to the patient, ensuring they understand the purpose and what to expect. Obtain informed consent from the patient or their legal guardian. Assemble all necessary equipment and ensure it is within easy reach. Position the Patient: Place the patient in a sitting position, with the head slightly forward and the neck slightly extended. This helps facilitate the passage of the tube into the stomach.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 12 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test6" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - AIIMS NOV 2019&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - AIIMS NOV 2019&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                12 Questions | 12 Total Marks | 22 min Duration | ~110.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Regarding CPR, False statement:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Can be given irrespective of rib fracture&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Adult chest compression and ventilation ratio is 30:2 with 2 rescuers&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Compression rate 100-120/min&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;AED if available, give compressions and shock every 3 minutes&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. AED if available, give compressions and shock every 3 minutes&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;AED if available, give compressions and shock every 3 minutes True, Chest compression is given at the lower one-third of the sternum True, chest compression and ventilation ratio for adults, irrespective of no. of rescuers is 30:2 True – compression rate is 100-120/minute False- Check rhythm after 2 minutes and give shock only if the rhythm is shockable True, for infants and children the ratio of compression and ventilation ratio is 30:2 with 1 rescuer however it changes to 15:2 with 2 rescuers.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A 65-year-old male patient is undergoing CPR for cardiac arrest due to a massive MI. All of the following statements related to his CPR are true except:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Sternum should be depressed by 2 inches&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Effective cardiac massage produces only one third of the normal cardiac output&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;End-tidal CO2 &amp;lt; 10 mmHg indicates unsuccessful CPR&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Mean arterial pressure &amp;lt; 20 mmHg indicates unsuccessful CPR&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Mean arterial pressure &lt; 20 mmHg indicates unsuccessful CPR&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Mean arterial pressure &amp;lt; 20 mmHg indicates unsuccessful CPR As coronary filling occurs during diastole therefore diastolic blood pressure is taken as a marker to check the success of CPR. Diastolic blood pressure (measured intra arterially) &amp;lt; 20 mmHg indicates unsuccessful CPR.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- In adults and children, the sternum should be depressed by at least one-third of the AP diameter {2 inches (5 cm)} but should not be more than 2.4 inches. In infants, it should be depressed by 1.5 inches. Option B- Successful cardiac massage produces only produce 25-30% of normal cardiac output therefore, restoration of normal rhythm and spontaneous circulation should be achieved as early as possible Option C- A successful cardiac massage should be able to produce ETCO2 &amp;gt; 20 mmHg. ETCO2 between 10-20 mmHg indicates that CPR requires improvement while ETCO2 &amp;lt; 10 indicates completely unsuccessful CPR.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Other than Diastolic blood pressure and ETCO2, mixed venous oxygen saturation is also used to see the success of CPR. Mixed venous oxygen saturation &amp;lt; 30% indicates unsuccessful CPR.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;The following four items consist of two statements, one labeled the ‘Assertion A’ and the other labeled the ‘Reason R’. You are to examine these two statements carefully and decide if the Assertion (A) and the Reason (R) are individually true and if so, whether the Reason is a correct explanation of the Assertion. Select your answers to these items using the codes given below the mark your answer sheet accordingly: Assertion – (A): For airway management flexion of the neck is required Reason – (R): Jaw thrust prevents the tongue from falling back on the posterior pharyngeal wall&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Both Assertion and Reasons are independently true/correct statements and the Reason is the true/correct explanation for the Assertion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Both Assertion and Reasons are independently true /correct statements, but the Reason is not the true/correct explanation for the Assertion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;The assertion is independently a true/correct statement, but the Reasons is independently a false/incorrect statement&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;The assertion is independently a false/incorrect statement, but the Reasons is independently a true/correct statement&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. The assertion is independently a false/incorrect statement, but the Reasons is independently a true/correct statement&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The assertion is independently a false/incorrect statement, but the Reasons is independently a true/correct statement A simple maneuver (triple maneuver) applied to prevent tongue fall includes neck extension, chin lift, and jaw thrust (i.e., pull the mandible anteriorly). Therefore, Assertion is wrong while reason is the correct statement.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Postoperative pulmonary complications are seen in all of the following BMI&amp;gt;30 Upper abdominal surgery Patient with 7 pack years of smoking Age &amp;gt; 70 Select the correct answer from the given below code:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;1, 2, and 3 are correct&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;1, 3, and 4 are correct&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;2, 3, and 4 are correct&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;1, 2, 3, and 4 are correct&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. 1, 2, 3, and 4 are correct&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;1, 2, 3, and 4 are correct One of the very important parts of preoperative evaluation is to determine the major risk factors which predispose the patient to postoperative pulmonary complications. The following factors have been cited as the major risk factors: Age &amp;gt; 60 years Severity of pulmonary disease (Dyspnea at minimal activity) ASA grade &amp;gt; 2 Congestive heart failure Heavy smoker Surgery under general anesthesia Surgical factors like site of surgery (thoracic and upper abdominal), nature (major), and duration (&amp;gt; 3 hours) Serum albumin &amp;lt; 3.5 g/dl Obesity (BMI&amp;gt; 30) – Obese patients have compromised lung functions Dyspnea at minimal activity and site of surgery are the 2 most important predictors of postoperative complications.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A patient with Supraventricular tachycardia became unconscious. What is next step?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Amiodarone&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Adenosine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Procainamide&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Immediate cardioversion&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Immediate cardioversion&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Immediate cardioversion Unstable SVT should be managed by immediate cardioversion while stable SVT can be managed by medical therapy. Management: Check for Responsiveness: First, ensure your safety. If the patient is in a potentially dangerous environment, move them to a safe location. Check if the patient is responsive by tapping their shoulders and shouting loudly, \&quot;Are you okay?\&quot; If they do not respond, they are unconscious. Activate Emergency Services: If the patient is unconscious, immediately call 911 or your local emergency number to request professional medical assistance. Provide your location and inform them that you have an unconscious SVT patient. Perform Basic Life Support (BLS): If the patient is not breathing or not breathing normally (gasping), initiate cardiopulmonary resuscitation (CPR) immediately. This involves chest compressions and rescue breaths. If you are trained in CPR, follow the recommended guidelines for your region. If you are not trained in CPR, the emergency dispatcher can provide instructions over the phone. Automated External Defibrillator (AED): If an automated external defibrillator (AED) is available, follow the AED&#x27;s prompts for using it. AEDs can analyze the heart rhythm and may advise a shock if a shockable rhythm is detected. Monitor Vital Signs: While awaiting the arrival of emergency services, monitor the patient&#x27;s vital signs, if possible. Pay attention to the pulse and breathing rate. Be prepared to continue CPR if necessary.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A solider was bought from Siachen suffering from hypothermia. Which of the following temperature closely reflects core temperature?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Oral&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Rectal&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Skin by infrared detectors&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Esophagus&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Esophagus&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Esophagus Best site for measuring core body temperature is the lower end of the esophagus. However, the most accurate is the pulmonary artery. Peripheral sites like skin are not considered highly reliable for measuring core body temperature.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Postoperative pulmonary complications are seen in all of the following (Mark True or False):&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;BMI&amp;gt;30&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Upper abdominal surgery&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Patient with 7 pack years of smoking&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Age &amp;gt; 70&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. BMI&gt;30&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;BMI&amp;gt;30 One of the very important part of preoperative evaluation is to determine the major risk factors which predispose the patient to post- operative pulmonary complications. The following factors have been cited as the major risk factors: Age &amp;gt; 60 years Severity of pulmonary disease (Dyspnea at minimal activity) ASA grade &amp;gt; 2 Congestive heart failure Heavy smoker Surgery under general anesthesia Surgical factors like site of surgery (thoracic and upper abdominal), nature (major) and duration (&amp;gt; 3 hours) Serum albumin &amp;lt; 3.5 g/dl Obesity (BMI&amp;gt; 30) – Obese patients have compromised lung functions Dyspnea at minimal activity and site of surgery are the 2 most important predictors of postoperative complications.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A patient was on epidural for post-op analgesia on a dose of 3 mg morphine/day. However, by mistake, one day accidentally 12 mg of morphine was injected through an epidural catheter. Which statement is not correct?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;The patient will complain of itching&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Supplement oxygen by the mask may be required&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;The patient will have urinary retention&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;The patient will complain of numbness in limbs.&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. The patient will complain of numbness in limbs.&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The patient will complain of numbness in limbs. As opioids don’t act on nerve roots so there is no possibility of numbness.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The advantage of opioids over local anesthetics No risk of hypotension No risk of motor/sensory paresis Disadvantages: Risk of respiratory depression&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option: A. Although the incidence of itching is more with the IV route however it does occur with epidural also particularly if a high dose is used like in this scenario. Option:B Supplemental oxygen may be required if patient oxygen saturation is subnormal Option:C Urinary retention is one of the major issues with opioids and local anesthetics.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Steps of intubation sequence are: Flexion of lower cervical spine and extension of Atlanto-occipital joint Inflate cuff of endotracheal tube Introduce laryngoscope from right side of mouth Confirm the position of tube Select the correct answer from given below code:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;a, b, c, d&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;a, b, d, c&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;b, a c, d&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;a, c, b, d&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. a, c, b, d&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;a, c, b, d Steps for intubation: Prepare equipments for difficult or failed intubation Position the patient: The optimal position for intubation is extension at atlanto-occipital joint and flexion at cervical spine. For right-handed people the laryngoscope should be held in left and introduced through the right angle of mouth displacing the tongue anteriorly. Once epiglottis is seen, it’s pushed forward to see the vocal cords. Once vocal cords are seen, the endotracheal tube is introduced. Inflate the cuff of endotracheal tube Verify the position of the tube by capnography.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Minimum INR before any elective surgery should be:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Less than 2.5&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Less than 2.0&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Less than 1.5&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Normal&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Less than 1.5&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Less than 1.5 Warfarin should be stopped 5 days prior to surgery However, before taking the patient for surgery it is mandatory to check INR before surgery. INR must be &amp;lt; 1.5 to consider the patient for surgery.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A, B- INR &amp;gt; 1.5 not only increases the risk of surgical bleeding but also becomes a contraindication of regional anesthesia unnecessary subjecting the patients to risks of general anesthesia. Option D- A normal INR may increase the chances of thrombosis in these vulnerable patients who are on anticoagulants. Therefore, target is not to achieve normal INR. INR &amp;lt; 1.5 does not increases the risk of bleeding and decreases the risk of thrombosis therefore the target is to keep INR below 1.5.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;True statement about the following image:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;It is part of advanced life support&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;It only delivers a shock of 300J&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;One pad is applied over the precordium and another over the sternum&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;It’s for use of common people&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. It’s for use of common people&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578223788-QTDTPYQ041IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;It’s for use of common people It’s an image of an automatic external defibrillator (AED). It automatically detects the rhythm and if the rhythm is shockable, it delivers the energy by itself. Since its automatic is meant for use by the public.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- As automatic external defibrillators can be used by the general public, they are part of basic life support. Option B- If biphasic, it delivers a shock of 150-200 J and if monophasic it will deliver a shock of 360 J. Option C- Apex pad is placed over precordium while the sternal pad is placed right infraclavicular.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Automatic external defibrillators are now called public access defibrillators (PAD).&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Match the following anesthetic agents with respect to their side effects [Column – (A) with Column – (B)]: Select the correct answer using the code below:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;a = 3 / b = 5 / c = 2 / d = 1&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;a = 6 / b = 2 / c = 4 / d = 5&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;a = 3 / b = 1 / c = 4 / d = 2&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;a = 5 / b = 1 / c = 3 / d = 4&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. a = 3 / b = 1 / c = 4 / d = 2&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578223813-QTDTPYQ102IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;a = 3 / b = 1 / c = 4 / d = 2 Propofol contains egg lecithin, however egg allergy is not a C/I. Wooden chest syndrome is exhibited by all pure opioid agonists. Although Benzodiazepines are safe from cardiac point of view but in high doses, they can cause hypotension as they can cause vasodilation. Nitrous oxide can increase pulmonary artery pressure by causing. Side effect of Propofol,Fentanyl,Midazolam,Nitrous Oxide&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 22 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test7" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INI CET JULY 2021&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INI CET JULY 2021&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                8 Questions | 8 Total Marks | 18 min Duration | ~135.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Ventilator support is required if SpO2 becomes less than 90% because:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Central chemoreceptors become insensitive to hypoxia below 90%&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Peripheral chemoreceptors become insensitive to hypoxia below 90%&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Tissues become vulnerable to hypoxia below 90%&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;The patient’s capacity to generate adequate tidal volume decreases below 90%&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Tissues become vulnerable to hypoxia below 90%&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Tissues become vulnerable to hypoxia below 90% Below the oxygen saturation of 90%, there occurs a sudden fall in SpO2 due to the sigmoid shape of the oxygen dissociation curve putting tissues at risk of hypoxia.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Options A &amp;amp; B- Central and peripheral remain responsive below spo2 of 90%. Option D- The patient’s capacity to generate tidal volume is not affected by oxygen saturation.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Factors affecting the oxygen dissociation curve To Left To Right Alkalosis Acidosis Low pCO 2 High pCO 2 Decreased 2,3 DPG Increased 2,3 DPG Carbon monoxide poisoning Hyperthermia Abnormal hemoglobins like  methemoglobin, fetal   hemoglobin, etc. Inhalational Hypophosphatemia Hypothermia&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;How long should elective surgery be deferred for a patient recovered from symptomatic COVID-19 without the requirement of hospitalization?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;4 weeks&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;8 weeks&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;12 weeks&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;6 weeks&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. 6 weeks&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;6 weeks The waiting time for elective surgeries from the diagnosis of COVID-19 as suggested by the American Society of Anesthesiologists. 4 weeks – For asymptomatic patients or recovery from only mild, non-respiratory symptoms 6 weeks – For a symptomatic patient (e.g., Cough, dyspnea) who did not require hospitalization 8 – 10 weeks – For a symptomatic patient who is hospitalized or who has comorbidities such as diabetes or who is immunocompromised 12 weeks – For a patient who was admitted in ICU due to COVID-19&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Most common cause of post operative admission after day care surgery is:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Pain&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Nausea and vomiting&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Bleeding&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Respiratory distress&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Bleeding&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Bleeding Most common postoperative complication of day care surgery – Drowsiness (50% – 60%) Most common cause of delay in discharge – Pain Most common cause of overnight stay or re-admission – Surgical complication (m/c – bleeding)&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;What is the mechanism of action of local anaesthetics?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Block Na+ Channels&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Block K + Channels&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Block Ca2 + Channels&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Block Chloride channels&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Block Na+ Channels&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Block Na+ Channels Local anaesthetics mainly acts by blocking sodium channels. Local anaesthetics may also bind and inhibit calcium, potassium, chloride channels and many other channels. But main action is on Sodium channels. The voltage gated sodium channels exists in 3 states : Resting Activated state and Inactivated state Sodium channels have one larger α Subunit and one or two smaller β subunits. The LA binds to α subunits of sodium channels, thereby preventing their activation and inhibiting influx of sodium.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Highest fractional inspired Oxygen is provided by which of the following:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Nasal Cannula&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Venturi mask&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Non rebreathing mask&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Hudson mask&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Non rebreathing mask&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Non rebreathing mask Oxygen delivery devices are classified as high flow systems and low flow systems. Non rebreathing mask Low flow device, that can be used to deliver oxygen at higher concentration FiO2 – 80 – 95% Reservoir bag – helps concentrate the oxygen One way valve – Doesn’t allow to breath in expired air Nasal cannula – Low flow, variable performance devices. Flow rate 1 – 6 L Flow rate FiO2 1L 24% 2L 28% 3L 32% 4L 36% 5L 40% 6L 44% Maximum FiO2 achieved by nasal cannula is 44% at the flow rate of 6L Hudson mask (Simple face mask) Low flow, variable performance device Flow rate – 6L/min FiO2 – 40 – 60% Venturi mask – high flow, fixed performance device Highest FiO2 – 60% At flow rate – 15 L/min It is available in different colours&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A 42 years old male patient was under home isolation after testing positive for COVID – 19. He develops breathing difficulty and is brought to the emergency room. Patient is alert, responsive but SpO2 of the patient is 86%. He is administered oxygen via a face mask with a reservoir bag at the flow rate of 10L/min. After trial of 1 hr, the SpO2 is 88%. What is the next step in management?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Endotracheal intubation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;High flow nasal cannula oxygen therapy&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Increase the flow rate to 15 L/min&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;No specific intervention necessary&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. High flow nasal cannula oxygen therapy&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;High flow nasal cannula oxygen therapy In this patient, the hypoxemia is not alleviated after receiving standard oxygen therapy. So, he should be started in high flow nasal cannula oxygen therapy High flow nasal cannula Flow rate – 30 – 60 L/min FiO2 – 100% Mechanism of action – Extrinsic PEEP, decreased work of breathing.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;In the image of the below-given monitor, the curve marked with the arrow indicates:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Oxygen partial Pressure&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Carbon dioxide&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Oxygen saturation&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Airway pressure&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Oxygen saturation&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578480550-QTDTPYQ012IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Oxygen saturation The graph marked here indicates pleth which is a short form of plethysmography. Plethysmography is the waveform of oxygen saturation (SPO2). The value of 98% is exhibited in the numerical box.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- Partial pressure of oxygen (po2) can be measured by blood gas analysis Option B- Expired CO2 is shown by capnography which is not displayed in this monitor. Option D- Although monitors can display airway pressure however usually airway pressures are exhibited by ventilators.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Plethysmography can be used for fluid titration.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following nerve is blocked in the local anesthetic technique given in the image?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Anterior ethmoidal nerve&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Nasociliary nerve&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Sphenopalatine nerve&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Greater palatine nerve&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Nasociliary nerve&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578480583-QTDTPYQ097IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Nasociliary nerve The image given shows Nasociliary nerve block The needle is inserted 1 cm superior and 1.5cm posterolateral to the medial canthal ligament of the eye Uses of Nasociliary block Surgery of nasal bone fractures Septoplasty Rhinoplasty Repair of skin laceration Nasociliary Nerve Block Ethmoidal Nerve Block Nerve Target Nasociliary nerve, a branch of the ophthalmic division (V1) of the trigeminal nerve (CN V). Ethmoidal nerves, which are branches of the nasociliary nerve. Indications Used for anesthesia or analgesia in ophthalmic procedures involving the cornea, iris, and ciliary body . Primarily for nasal surgery, particularly procedures involving the middle or superior nasal turbinates. Procedure By injecting a local anesthetic near the medial canthus of the eye, targeting the nasociliary nerve&#x27;s path. By injecting a local anesthetic into the nasal mucosa, targeting the ethmoidal nerves as they branch from the nasociliary nerve. Anesthetic Area Provides anesthesia to the upper part of the face, including the forehead, scalp, and upper eyelid. Provides anesthesia to the nasal cavity and adjacent structures. Common Uses Corneal or intraocular procedures. Nasal surgeries and procedures, such as endoscopic sinus surgery.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 18 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test8" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INI CET MAY 2022&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INI CET MAY 2022&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                2 Questions | 2 Total Marks | 12 min Duration | ~360.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Which of the following options correctly represent the increasing order of potency of inhalational anesthetic agents?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;N2O &amp;lt; Isoflurane &amp;lt; Halothane &amp;lt; Methoxyflurane&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Methoxyflurane &amp;lt; halothane &amp;lt; isoflurane &amp;lt; N2O&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Halothane &amp;lt; Isoflurane &amp;lt; methoxyflurane &amp;lt; N2O&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Isoflurane &amp;lt; N2O &amp;lt; Halothane &amp;lt; Methoxyflurane&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. N2O &lt; Isoflurane &lt; Halothane &lt; Methoxyflurane&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;N2O &amp;lt; Isoflurane &amp;lt; Halothane &amp;lt; Methoxyflurane The MAC of an inhaled anesthetic is the alveolar concentration that prevents movement in 50% of patients in response to a standardized stimulus (eg, surgical incision). Useful measure because it mirrors brain partial pressure, allows comparisons of potency between agents, and provides a standard for experimental evaluations Lower the MAC higher is the potency. This is because potency is inversely proportional to MAC (Minimum Alveolar Concentration). Methoxyflurane &amp;gt; Halothane &amp;gt; Isoflurane &amp;gt; Enflurane &amp;gt; Ether &amp;gt; Sevoflurane &amp;gt; Desflurane &amp;gt; Xenon &amp;gt; Nitrous oxide N 2 O - Nitrous oxide can be used for general anesthesia, procedural sedation, dental anesthesia, and to treat severe pain . Nitrous oxide&#x27;s potent analgesic properties can be useful in providing analgesia in settings such as the obstetrical ward or emergency department. Isoflurane is an inhaled general anesthetic used in surgery. A stable, non-explosive inhalation anesthetic, relatively free from significant side effects. Halothane is a general inhalation anesthetic used for induction and maintenance of general anesthesia. It reduces the blood pressure and frequently decreases the pulse rate and depresses respiration . It induces muscle relaxation and reduces pain sensitivity by altering tissue excitability. Methoxyflurane is a volatile anesthetic originally used in the 1960s until it was found to be nephrotoxic at anesthetic doses3 (typically 40–60 mL). Since the 1970s it has been used in Australia in lower doses for acute analgesia (up to 6 mL), largely by paramedic services.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Transcutaneous electrical nerve stimulation is used to relive pain. What is the mechanism behind it?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Descending Inhibition&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Gate Control Theory&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Central Inhibition&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Sensitization&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Gate Control Theory&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Gate Control Theory Transcutaneous electrical nerve stimulation (TENS) is widely used to relieve a wide range of painful conditions, including non-malignant acute and chronic pain and pain resulting from cancer and its treatment. During TENS pulsed electrical currents are generated by a small battery operated TENS device that can be kept in the pocket or attached to the user&#x27;s belt. Currents from the TENS device are delivered through the skin by two self-adhering electrode pads The purpose of TENS is to selectively activate nerve fibers. Maximal pain relief is achieved when TENS generates a strong non-painful electrical sensation beneath the electrodes. Pain relief is usually rapid in onset and stops shortly after TENS is turned off. For this reason patients are encouraged to deliver TENS for as long as needed, which may be for hours at a time and throughout the day. It is based on the gate control theory of pain According to this Gate-Control Theory of Pain, activity in large diameter low threshold mechanoreceptive (touch-related) nerve fibers could inhibit the transmission of action potentials from small diameter higher threshold nociceptive (pain-related) fibers through pre and post synaptic inhibition in the dorsal horn of spinal cord. Because nociceptive fibers (A-delta and C-fibers) have a higher threshold of activation than mechanoreceptive fibers (A-beta fibers) it was proposed that it would be possible to selectively stimulate mechanoreceptive fibers by titrating the amplitude of electrical currents delivered across the surface of the skin (ie TENS). This would prevent signals from nociceptive fibers from reaching higher centres of the brain, thus reducing pain&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A - This descending inhibition can be selective, with different regions of the brain inhibiting certain inputs to the spinal cord . Some regions reduce mechanoreceptive input, and others reduce noxious and warmth inputs. Descending inhibition can also reduce input from the skin while increasing input related to movement. Option C - At the level of the spinal cord, opioids can inhibit transmitter release from primary afferent terminals as well as activity of pain transmission neurons . Norepinephrine (NE) release from spinopetal noradrenergic fibers from medullary sites also inhibits pain transmission. Option D - central sensitization represents an abnormal state of responsiveness or increased gain of the nociceptive system . The pain is effectively generated as a consequence of changes within the CNS that then alter how it responds to sensory inputs, rather than reflecting the presence of peripheral noxious stimuli.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 12 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test9" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INI CET MAY 2023&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INI CET MAY 2023&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                3 Questions | 3 Total Marks | 13 min Duration | ~260.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;A 70 kg patient who presented to the emergency with acute pancreatitis was shifted to the ICU and intubated. His ventilatory settings are: FiO2 90%, PEEP 12 mmHg, respiratory rate 16/min, and tidal volume 420 ml. The results of the ABG analysis are given below. Which of the following would be the next step in the management of this patient? pH: 7.33 PaO2: 110 mmHg PaCO2: 58 mmHg SpO2 100%&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Decrease RR&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Increase Tidal Volume&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Increase PEEP to 14 cm&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Decrease FiO2&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Decrease FiO2&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Decrease FiO2 In a patient with a history of acute pancreatitis who needed to be intubated, the diagnosis is ARDS most likely. In this patient  Pao2 is 110 mmHg and the spo2 is 100% which is significantly higher than that of target recommended in patients with  ARDS. The next best step in this is to reduce FiO2 to prevent any further lung injury and worsening of ARDS due to oxygen toxicity.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The fraction of inspired oxygen (FiO2) is the concentration of oxygen in the gas mixture. The gas mixture at room air has a fraction of inspired oxygen of 21%, meaning that the concentration of oxygen at room air is 21%. The percentage of oxygen at different altitudes remains the same, meaning the FiO2 of air in the atmosphere remains 21%, irrespective of the altitude of an individual Hypoxemia: Is defined as a decrease in the partial pressure of oxygen in the blood. PaO2: Partial pressure of oxygen of arterial as measured by an arterial blood gas Sample. PAO2: Partial pressure of oxygen of the alveoli, a calculated value Oxygen delivery devices such as a nasal cannula, venturi mask, and high-flow nasal cannula can deliver varying FiO2. A patient breathing ambient air is inhaling a FiO2 of 21%. Oxygen delivery devices determine the flow rate and FiO2 based on predicted equipment algorithms. The conventional prediction model states that for every liter of oxygen supplied, the FiO2 increases by 4%. Therefore, a nasal cannula set at a 1 L/min flow rate can increase FiO2 to 24%, 2 L/min to 28%, 3 L/min to 32%, 4 L/min to 36%, 5 L/min to 40%, and 6 L/min to 44%. In the setting of critically ill patients , FiO2 is routinely used to assess the lungs&#x27; capacity for gas exchange., using the PaO2/FiO2 (P/F) ratio, where PaO2 represents the partial pressure of oxygen. The most notable use of this metric is in the Berlin criteria , which categorizes ARDS as mild (201 to 300 mmHg), moderate (101 to 200 mmHg), and severe (less than 100 mmHg). While cardiac output , hemoglobin concentration, and barometric pressure can affect the P/F ratio, it remains a reasonable assessment of pulmonary function&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option: A. Decrease RR is incorrect statement associated with above question. Option: B. Increase Tidal Volume is incorrect statement as condition requires low tidal volume ventilation. Option: C. Increase PEEP to 14 cm is incorrect statement.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;The presence of which of the following indicates that CPR is of high quality? CHEST Compression at rate of 100-120 per min Allow adequate recoil Depth of compression should be 5 to 6 cm Respiration at rate of 20-25 per min Select the correct answer from the given below code:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;a c d&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;a d&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;a b c&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;only d&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. a b c&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;a b c ●       Chest compression rate 100-120/minute ●       Depth of compression 5-6 cm ●       Compression :ventilation ratio 30:2&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;ACLS Guideline For Cardiac Arrest BLS (Basic Life Support) interventions should be initiated immediately when a patient experiences cardiac arrest. Early defibrillation is a key intervention for shockable rhythms (ventricular fibrillation or pulseless ventricular tachycardia). Use an automated external defibrillator (AED) or manual defibrillator as soon as available. High-quality chest compressions are crucial for maintaining blood circulation. Depth of compressions should be at least 2 inches (5 cm) in adults, at a rate of 100-120 compressions per minute. Allow full chest recoil after each compression.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A patient who is under general anesthesia shows the following on the Et CO2 monitor. Which condition can lead to this characteristics waveform on capnography?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Bronchospasm&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Pericarditis&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Cardiac tamponade&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Viral myocarditis&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Bronchospasm&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578059456-QTDTPYQ084IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Bronchospasm The above capnographic waveform depicts bronchospasm. Shark fin appearance-Prolonged phase of II, increased alpha angle, and steeper phase III suggest bronchospasm or airway obstruction.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Capnographic waveforms&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option B.Pericarditis -Capnography, which measures end-tidal carbon dioxide (EtCO2), is used to monitor a patient&#x27;s ventilation and respiratory status. It can be valuable in ensuring proper airway management during procedures, confirming endotracheal tube placement, and assessing the effectiveness of ventilation. However, it is not typically used as a diagnostic tool for pericarditis. Option C.Cardiac tamponade While a capnograph is a valuable tool for monitoring a patient&#x27;s ventilation and respiratory status, it is not specifically used for diagnosing cardiac tamponade. Diagnosis and management of cardiac tamponade involve medical history, physical examination, Option D.Viral myocarditis capnograph is not typically used as a primary diagnostic tool for viral myocarditis. Viral myocarditis is an inflammation of the heart muscle caused by a viral infection. Diagnosis of viral myocarditis involves a combination of clinical assessment, medical history, physical examination, laboratory tests, imaging studies, and sometimes cardiac biopsy.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 13 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test10" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INI CET NOV 2020&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INI CET NOV 2020&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                6 Questions | 6 Total Marks | 16 min Duration | ~160.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;On your morning walk in the park, you noticed an unconscious man lying on the road. Which of the following options indicates the best next steps?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Check carotid pulse, start CPR and call for help, defibrillate if no pulse&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Call for help, check pulse, do CPR, Defibrillate if no pulse&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Observe and wait till the ambulance arrives&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Defibrillate, check pulse and do CPR&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Call for help, check pulse, do CPR, Defibrillate if no pulse&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Call for help, check pulse, do CPR, Defibrillate if no pulse ALGORITHM FOR CPR&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Blue pipeline in OT is for which anesthetic gas:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Oxygen&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Nitrous oxide&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Air&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Vacuum&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Nitrous oxide&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Oxygen In larger hospitals where the consumption of gases is more, it is not possible to change cylinders frequently therefore, oxygen, nitrous oxide and air are supplied through central supply pipelines. Blue color code is given for the pipeline of nitrous oxide.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The color coding for central supply pipelines is: White- Oxygen Blue- Nitrous oxide Black - Air Choice C- The gases through central supply in India are supplied at a pressure of 60 PSI. Oxygen cylinders are filled at a pressure of 2000PSI while the pressure in nitrous oxide cylinder is 760 PSI.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;The position of the patient in the Image shown below is :&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Trendelenburg&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Reverse Trendelenburg&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Lloyd Davis position&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Jack Knife position&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Reverse Trendelenburg&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578017462-QTDTPYQ098IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Reverse Trendelenburg&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Match the following dilution of adrenaline and its use (Column – (A) with Column – (B): Select the correct answer from the given below code:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;A-1, B-2, C-3&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;A-2, B-1, C-3&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;A-3, B-2, C-1&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;A-1, B-3, C-2&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. A-2, B-1, C-3&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578017455-QTDTPYQ045IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;A-2, B-1, C-3 Dose Concentration 1. CPR: 1 mg to be repeated every 3-5 min. IV/IO/ET - 1: 10,000 ET in children- 1: 1,000 2. Anaphylaxis: 0.5-1 mg to be repeated every 3-5 minutes. IM (and S/C) – 1: 1000 IV/IO/ET - 1: 10,000 3. With local anesthetics. 1: 2,00,000 4. For producing local ischemia 1: 1,00,000&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Identify the equipment:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Mechanical ventilator without a monitor&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Infusion pump&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;CPAP Machine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;High-flow nasal cannula&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. High-flow nasal cannula&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578017415-QTDTPYQ030IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;High-flow nasal cannula This is a high-flow nasal cannula (HFNC) that can deliver very high flow (up to 70 L/mt). through the nasal cannula.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- HFNC delivers humidified oxygen and it is necessary to deliver humidified oxygen otherwise dry oxygen with such high flows will inhibit ciliary activity. Inhibition of cilia will lead to the retention of secretions leading to atelectasis. Option B- Such high flow creates a PEEP of 4-5 mmHg. Option D- kindly check right option explanation given in wrong option explanation&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;The given set of instruments are used in:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Central line insertion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Arterial line insertion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Airway management tray&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Umbilical catheter insertion&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Airway management tray&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696578017380-QTDTPYQ004IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Airway management tray This is the airway management set and it should include: Masks of all sizes (which are not shown in this figure) Airways of all sizes Laryngoscopes with all blade sizes Endotracheal tubes of all sizes Bougies and stylet for difficult intubation Suction catheter Lignocaine spray Laryngeal mask airway Syringe to inflate the cuff of endotracheal tube Adhesive plast for fixation of tube Manual resuscitation bag (AMBU)&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 16 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test11" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INI CET NOV 2021&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INI CET NOV 2021&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                4 Questions | 4 Total Marks | 14 min Duration | ~210.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Maximum O2 flow rate through conventional oxygen mask?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;5L&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;10L&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;15L&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;20L&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. 10L&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;10L Nasal cannulae Deliver 24-30% oxygen Flow rate 1-4L/min (4L will dry the nose, 2L is more comfortable) Used in non-acute situations or if only mildly hypoxic (e.g. saturations stable at 92% in a patient without lung disease) Hudson mask Delivers 30-40% oxygen Flow rate 5-10L/min Venturi mask Delivers 24-60% oxygen Types: BLUE = 2-4L/min = 24% O2 WHITE = 4-6L/min = 28% O2 YELLOW = 8-10L/min = 35% O2 RED = 10-12L/min = 40% O2 GREEN = 12-15L/min = 60% O2 Often used in COPD , where it is important not to over-oxygenate the patient. Non-rebreather mask Delivers 85-90% oxygen 15L flow rate Bag on mask with valves stopping almost all rebreathing of expired air Used for acutely unwell patients Note that saturations should be maintained at 94-98%, not 100%. Do not keep patients on 15L for longer than necessary as over-oxygenating for prolonged periods can be harmful&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;An ASA 1 patient was undergoing Laparoscopic cholecystectomy. It was noticed that ETCO2 decreased to 8mm of Hg, SpO2 became 90%, BP dropped to 80/50 mmHg and peak airway pressure increased to 18mmHg. What is the most probable diagnosis in this case?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;CO2 embolism&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Severe bronchospasm&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Endobronchial intubation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Pneumothorax&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Pneumothorax&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Pneumothorax Beyond any doubt, the patient has developed.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Pneumothorax by highly diffusible gas like CO2 resolves spontaneously in 30-60 minutes. So, chest tube drainage should be reserved only for life-threatening cases. Conservative measures like 100 % oxygen, and reducing intra abdominal pressure improve the hypoxia and are sufficient to manage pneumothorax by CO2 in most cases.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A. In CO2 embolism ETCO2 will show a rise followed by a fall. Moreover, there will not be an increase in airway pressures. Option B. In bronchospasm generally, ETCO2 remains normal, only the graph shows a shark fin pattern. Moreover, hypotension will not be seen in bronchospasm. Option C. ETCO2 will rise and show bifid pattern in endobronchial intubation.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which agent is used as the sole agent for induction and maintenance and endotracheal intubation?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Isoflurane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Desflurane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Sevoflurane&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Halothane&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Sevoflurane&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sevoflurane Sevoflurane has the smoothest induction, therefore, is the inhalational agent of choice for induction in children. All inhalational agents are used for maintenance. In rare cases, particularly neonates, infants, and patients with neuromuscular diseases patients are directly intubated without muscle relaxants under the effect of volatile agents Difference between sevoflurane and isoflurane : Aspect Sevoflurane Isoflurane Onset of Action Rapid onset of action. Slightly slower onset compared to sevoflurane. Blood-Gas Solubility Low blood-gas solubility, leading to rapid emergence from anesthesia. Moderate blood-gas solubility, slightly longer emergence time compared to sevoflurane. Irritation and Odor Generally has a pleasant odor and is less irritating to airways. Characteristic odor and Considered slightly more irritating than sevoflurane. Use in Pediatrics Commonly used in pediatric anesthesia due to its rapid induction and emergence properties. Also used in pediatric anesthesia but  have a slightly longer emergence time. Special Considerations Known for low pungency and lower potential for airway irritation. May require a higher fresh gas flow rate due to its higher blood-gas solubility.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- Isoflurane has unpleasant induction therefore cannot be used for induction and intubation Option B- Desflurane also has irritation induction therefore cannot be sued for induction and intubation Option D- Halothane has got pleasant induction however at high doses needed for intubation it is highly toxic&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A patient after an RTA was received in an emergency with the following cannula in the picture. What is the maximum flow rate of fluid through this cannula?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;86 ml/min&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;66 ml/min&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;96 ml/min&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;106 ml/min&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. 96 ml/min&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;96 ml/min Flow with an 18 G cannula is approximately 100 ml/minute.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Gauge Color Flow (ml/min.) 14 Orange 240 16 Grey 200 18 Green 96-100 20 Pink 64 22 Blue 38 24 Yellow 22 26 Purple 14&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 14 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test12" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INI CET NOV 2022 (PART A)&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INI CET NOV 2022 (PART A)&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                2 Questions | 2 Total Marks | 12 min Duration | ~360.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Which of the following is not included in Rapid sequence Intubation:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Pre oxygenation with 100% oxygen for 3 minutes&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Used in cardiac arrest patient&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Induction agent and muscle relaxant are given simultaneously&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;High volume cuff is used&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Induction agent and muscle relaxant are given simultaneously&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Induction agent and muscle relaxant are given simultaneously Muscle relaxant, Suxamethonium is given just after induction RSI is a technique of anesthesia induction in patients who are at an increased risk of gastric regurgitation and pulmonary aspiration of gastric contents . Examples : Pregnancy, intestinal obstruction, poorly controlled gastroesophageal reflux disease, morbid obesity. Cardiac arrest patients should also be considered as full stomach. The goal is to intubate rapidly to minimize the time between the loss of consciousness and securing of the airway with a cuffed endotracheal tube .&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which among the following are required in Cannulation of new-born baby: 22G Needle 24 Gauge Needle Adhesive Tape 5ml Syringe Normal Saline Select the correct answer from the given below code:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;1, 3, 4, and 5 is correct&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;2, 3, 4 and 5 is correct&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;2, 3 and 4 is correct&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;All of the above is correct&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. 2, 3, 4 and 5 is correct&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;2, 3, 4 and 5 is correct For cannulation in newborns, we would require a 24G needle, 5 mL syringe, adhesive tape, and normal saline. We use a 24G needle for &amp;gt;1 kg neonate, and for &amp;lt;1 kg neonate, we use a 28G needle. We need to avoid using 1 mL syringes for flushing as it may lead to catheter rupture; preferably, use 5 or 10 mL syringes. Flushing of the cannulation is done using 0.9% sodium chloride or so-called normal saline (NS).&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 12 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test13" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INI CET NOV 2022 (PART B)&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INI CET NOV 2022 (PART B)&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                3 Questions | 3 Total Marks | 13 min Duration | ~260.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;An infant was brought unconscious to the emergency. Arrange the following steps done in sequence for a patient who is Unconscious?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;4-5-1-3-2&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;5-1-4-2-3&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;4-5-1-2-3&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;5-1-2-4-3&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. 4-5-1-2-3&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;4-5-1-2-3 Any unresponsive infant should be initially resuscitated under pediatric BLS protocol According to this protocol the answer would be (considering you are a single health care provider) Check for responsiveness Check breath sounds and pulse simultaneously Chest compression Bag and mask ventilation&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following nerves is blocked for hernia surgery, femoral catheter local anesthesia is given just below the inguinal ligament for placing the femoral catheter?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Genitofemoral nerve&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Femoral nerve&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Lateral cutaneous nerve of the thigh&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Obturator nerve&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Genitofemoral nerve&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Genitofemoral nerve Genitofemoral nerve is blocked when the local anesthesia is given just below the inguinal ligament during femoral vein catheterisation. The genitofemoral nerve originates from L1 and L2 ventral rami , divides into genital and femoral branches after crossing behind the ureter. Genitofemoral nerve gives sensory supply to the anterolateral thigh via the femoral branch. The genital branch supplies skin of the scrotum in males and mons pubis and labia majora in females. It also innervates the cremaster muscle via the genital branch and is responsible for the cremasteric reflex.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of these agents is preferred for day care anesthesia?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Propofol&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Ketamine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Thiopentone&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Etomidate&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Propofol&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Propofol Propofol is the best drug for day care surgery as it has the following benefits over other IV anesthetics Rapid return of consciousness with no residual effects Antiemetic Pleasant recovery Propofol (25-50 mcg/kg/min) is the most commonly used drug for induction of anesthesia, maintenance of sedation and treatment of nausea and vomiting. Etomidate (0.2 – 0.3 mg/kg) is preferred when hemodynamic stability is importanT Other day care agents include Inhalational – Desflurane/ sevoflurane Opioid – Remifentanyl Benzodiazepine – Midazolam&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 13 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test14" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INI CET NOV 2023&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INI CET NOV 2023&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                2 Questions | 2 Total Marks | 12 min Duration | ~360.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Which of the following best represents the American Society of Anesthesiologists (ASA) physical status III?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Mild systemic disease&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Moderate systemic disease&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Severe systemic disease&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Severe systemic disease with threat to life&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Severe systemic disease&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Severe systemic disease Severe systemic disease best fits into grade 3 of the ASA classification. Grade III is also sometimes called as MODERATE SYSTEMIC ILLNESS WITH LIMITATION OF FUNCTION . American Society of Anesthesiologists classification is used to define relative risk prior to conscious sedation and surgical anesthesia . It is strongly correlates to perioperative risk . ASA Classification Definition of Patient  Status Examples ASA I ASA II ASA III ASA IV ASA V Normal health. Mild systemic disease. Severe systemic disease. Severe systemic disease that is constant threat to life. Moribund, not expected to survive without operation Healthy, non-smoking, no alcohol use. Current smoker, well-controlled DM and HTN Poorly controlled DM or HTN Recent MI, CVA, TIA, or CAD/stents Ruptured abdominal, thoracic aneurysm, massive trauma, intracranial bleed with mass effect ASA indicates American Society of Anesthesiology.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A 5-year-old is on 3L/min O2 via a nasal cannula. What is the appropriate FiO2 level for this child?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;25&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;30&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;45&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;60&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. 30&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;30 The formula for calculating FiO2 for a child on oxygen supplementation through nasal cannula is FiO2= 21%+ (nasal cannula flow in L/min) × 4 Therefore, at 3L/min, FiO2 = 21+3x4 = 33% Hence, best answer is 30 %&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Oxygen delivery devices have been classified as: Fixed performance devices or high flow system: In this category included are venturi masks, and high airflow blenders. These are fixed-performance devices because their output is not affected by changes in patient respiratory parameters. Variable performance devices or low flow system: The devices like a simple oxygen mask and nasal cannula are included in this category. These are variable performance devices because their performance is affected by changes in patient respiratory parameters. Oxygen delivery devices : Device Maximum flow (L/mt) Maximum FIO2 Type Nasal cannula 6 0.44 (40%) Variable performance 02 mask 10 0.6 Variable performance 02 mask with reservoir 15 0.8 Variable performance Air entrainment devices (venturi mask) 15 0.6 Fixed performance High flow nasal cannula 60 1.0 Fixed performance&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 12 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test15" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - INICET MAY 2024&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - INICET MAY 2024&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                6 Questions | 6 Total Marks | 16 min Duration | ~160.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;What is the inhalational induction agent used in children:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Nitrous oxide&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Isoflurane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Sevoflurane&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Desflurane&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Sevoflurane&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sevoflurane The inhalational induction agent commonly used in children is Sevoflurane Sevoflurane is favored for its rapid onset and minimal irritation, making it ideal for inhalational induction in pediatric patients. Sevoflurane : It is the preferred inhalational agent for induction in pediatric patients due to its rapid onset, minimal airway irritation, and pleasant odor, making it easier for children to tolerate.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option: A. Nitrous Oxide : Often used as a supplement to other agents rather than as a primary induction agent due to its analgesic properties. Option: B. Isoflurane : Effective for maintenance of anesthesia but less commonly used for induction in children because of its pungent odor and potential airway irritation. Option: D. Desflurane : Not typically used for induction in children due to its high vapor pressure and irritating properties, which can make it difficult for children to tolerate.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Table:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;#MANTRA INHALED ANESTHETICS (children) HALOTHANE ●       agent of choice for inhalational induction in children ( before sevoflurane ) ●       potent agent with slower induction ●       myocardial depressant ●       arrhythmias SEVOFLURANE ● agent of choice for inhalational induction in children ●       MAC similar with infant and neonates ●       epileptiform changes in EEG ( higher doses) ●       Emergency delirium ISOFLURANE ●       more potent than sevoflurane ●       noxious smell NITROUS OXIDE ●       speed uptake of more potent anesthetics ●       can be used for induction in cooperative children ●       Used alone or in conjunction with other agents ( procedural sedation or analgesia in children) ●       Role in maintenance decreased due to increased risk of postoperative nausea and vomiting XENON ●       odorless , anesthetic gas with low potency ●       superior anesthetic for children with significant congenital heart disease ( only preliminary data) DESFLURANE ●       pungent odor ●       causes laryngospasm ( not used for induction) ●       used for maintenance of anesthesia in children&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following is not a component of high quality CPR in adults:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Chest compression 100-120/min&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Allowed to completely recoil&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Depth of compression 3-4 cms&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;30 : 2 breaths compression&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Depth of compression 3-4 cms&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Depth of compression 3-4 cms The option that is not a component of high-quality CPR in adults is Depth of compression 3-4 cms&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;CPR in adults Push hard: 5-6cm depth Push fast: 100-120/min frequency Allow for complete chest recoil Minimize interruptions in compressions &amp;lt;10 seconds Avoid excessive ventilation Rotate compressor every 2 min or earlier if fatigued If no advanced airway, 30:2 compression-ventilation ratio Attempt to improve CPR quality if : Quantitative waveform capnography PETCO2 &amp;lt;10mmHg, Intra-arterial pressure - If relaxation phase (diastolic) pressure &amp;lt;20mmHg&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A patient was planned for surgery under general anesthesia, In the induction phase rocuronium 85 mg was given, but there was unsuccessful induction. Which of the following drugs can be given for immediate reversal effect of the drug?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Sugammedex&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Glycopyrrolate&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Neostigmine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Edrophonium&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Sugammedex&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sugammedex The drug that can be given for the immediate reversal of rocuronium is Sugammadex Sugammadex provides a rapid and effective reversal of rocuronium-induced neuromuscular blockade, making it the drug of choice in this scenario.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Aspect Details Class Selective relaxant binding agent (SRBA) Mechanism of Action Encapsulates and inactivates rocuronium and vecuronium, reversing neuromuscular blockade Indications Reversal of neuromuscular blockade induced by rocuronium or vecuronium Administration Intravenous injection Onset of Action Rapid, typically within 1-3 minutes Common Side Effects Nausea, vomiting, hypotension Serious Side Effects Anaphylaxis, bradycardia, cardiac arrest Contraindications Hypersensitivity to sugammadex or its components Special Considerations Use with caution in patients with renal impairment; not effective for other muscle relaxants like succinylcholine Advantages Rapid and reliable reversal of neuromuscular blockade, does not require anticholinergics Sugammadex : Specifically designed to reverse the effects of rocuronium and vecuronium. It works by encapsulating these neuromuscular blockers, thus neutralizing their effects rapidly and effectively.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Option: B. Glycopyrrolate : An anticholinergic agent used to counteract the effects of anticholinesterases but not effective for reversing neuromuscular blockers like rocuronium. Option: C. Neostigmine : An anticholinesterase agent used to reverse neuromuscular blockade induced by non-depolarizing neuromuscular blockers, but it is not as immediate or effective as sugammadex for rocuronium. Option: D. Edrophonium : Another anticholinesterase agent that can reverse neuromuscular blockade but is less effective compared to sugammadex for rocuronium.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following is a 2nd generation LMA device?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Proseal LMA&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Intubating LMA&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Flexible&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;AMBU&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Proseal LMA&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Proseal LMA The Proseal LMA is a 2nd generation Laryngeal Mask Airway (LMA) device. Proseal LMA : A 2nd generation LMA that features a gastric drain tube and an improved seal, allowing for better ventilation and the possibility of suctioning the stomach contents, which helps in preventing aspiration.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Laryngeal mask airways are classified as first generation and second generation FIRST GENERATION Classical LMA Also called Brain mask Cuff is inflated with 30-40ml air for adult size Ventilated through ports 7 different sizes available LMA unique ( disposable) LMA flexible ( enforced with wire to make it flexible) SECOND GENERATION Decrease chance of aspiration by better seal Intubating LMA ( up to 8 no. ET tube can be guided through it Proseal LMA ( larger and posterior cuff with better seal along with drain tube to deflate stomach) Supreme LMA ( bite block is present to avoid damage if patient bites) I-Gel ( contain drain tube to deflate stomach) LMA C-Trach ( LMA attached to screen to visualize)&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Option: B. Intubating LMA : A 2nd generation LMA designed for facilitating intubation if needed, but it is primarily used for its ability to secure the airway during procedures. Option: C. Flexible LMA : Not typically classified as a 2nd generation LMA. It is a variation designed for more flexible insertion but does not have the same features as the 2nd generation devices. Option: D. AMBU : Refers to the AMBU AuraLITE, which is also a 2nd generation LMA device, but not as specific as Proseal in terms of features. Therefore, the Proseal LMA is specifically recognized as a 2nd generation LMA device with added features for enhanced airway management.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Table:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;#MANTRA LARYNGEAL MASK AIRWAY ADVANTAGES DISADVANTAGES CONTRAINDICATIONS Avoid complications related to intubation Easy to insert- Does not require a laryngoscope Can be placed without muscle relaxant Less sympathetic stimulation compared to intubation Reusable Increased risk of aspiration Laryngospasm Trauma to oral cavity and injury to hypoglossal nerve sore throat Full stomach patients Hiatus hernia , pregnancy Oro pharyngeal abscess or mass&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A person is presented to ER- in an unconscious state, and found to be hypotensive dyspneic and with altered sensorium - with a narrow complex QRS. What is the next best step in management:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;IV amiodarone bolus with infusion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;IV adenosine stat&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Synchronized cardioversion&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Carotid sinus massage&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Synchronized cardioversion&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Synchronized cardioversion In an unconscious patient who is hypotensive, dyspneic, with altered sensorium, and a narrow complex QRS, the next best step in management is Synchronized Cardioversion Synchronized Cardioversion : This is indicated for patients with unstable tachycardias, especially when there are signs of poor perfusion or altered sensorium. It is used to restore normal rhythm in cases of narrow complex tachycardia that is causing hemodynamic instability.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Option: A. IV Amiodarone Bolus with Infusion : Typically used for ventricular arrhythmias or wide complex tachycardia, and would be considered if the patient had stable or less severe symptoms. Option: B. IV Adenosine Stat : Used for the immediate treatment of paroxysmal supraventricular tachycardia (SVT), but typically for patients who are stable. It is not usually the first step in a severely unstable patient. Option: D. Carotid Sinus Massage : Used to terminate certain types of SVT in stable patients but is not appropriate for an unstable patient with altered sensorium and hypotension. Thus, in the context of an unstable patient with altered mental status and hypotension, synchronized cardioversion is the appropriate and immediate intervention.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following is not a suitable method for free flow oxygen delivery to a newborn baby?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Oxygen tube kept close to the baby&#x27;s nose and mouth&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Oxygen mask placed firmly over the baby&#x27;s mouth and nose&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Self-inflated bag attached to an oxygen mask placed over baby&#x27;s mouth and nose&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;A reservoir bag attached to oxygen mask kept over the baby&#x27;s nose and mouth&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Self-inflated bag attached to an oxygen mask placed over baby&#x27;s mouth and nose&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Self-inflated bag attached to an oxygen mask placed over baby&#x27;s mouth and nose The option that is not a suitable method for free-flow oxygen delivery to a newborn baby is Self-inflating bag attached to an oxygen mask placed over baby&#x27;s mouth and nose Thus, the self-inflating bag is used for positive pressure ventilation and not for free-flow oxygen delivery. Self-Inflating Bag : This device is used for positive pressure ventilation, not for free-flow oxygen delivery. It is intended for situations where mechanical ventilation support is needed rather than simply providing supplemental oxygen.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Option: A. Oxygen Tube Kept Close to the Baby&#x27;s Nose and Mouth : This method allows for free-flow oxygen delivery, where oxygen is delivered directly to the baby without a mask. Option: B. Oxygen Mask Placed Firmly Over the Baby&#x27;s Mouth and Nose : This method ensures that oxygen is delivered effectively but is not considered free-flow, as it involves a direct mask interface. Option: D. A Reservoir Bag Attached to Oxygen Mask Kept Over the Baby&#x27;s Nose and Mouth : This setup can provide high-flow oxygen and is also not a free-flow method but is used for higher concentration oxygen delivery.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 16 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test16" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - NEET PG 2018&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - NEET PG 2018&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                8 Questions | 8 Total Marks | 18 min Duration | ~135.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;3-year-old undergoing squint surgery, initially heart rate was 140/min. After anesthesia and starting surgery heart rate is 40/min. Next appropriate step is:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Stop surgery&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Decrease plane of anesthesia&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Inj. glycopyrrolate&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Inj. atropine&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Inj. atropine&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Inj. atropine Squint surgery is done under general anesthesia. During GA excessive vagal activity, which causes severe bradycardia and hypotension can be life-threatening. The trigger can be painful stimulation of the bronchial, pharyngeal, laryngeal or esophageal mucosa. Prompt treatment is needed with urgent restoration of venous return by leg elevation, head down tilt and IV fluids, and the use of anticholinergic and sympathomimetic drugs. A pacemaker should be considered for patients with vasovagal syncope which is frequent and does not respond to medical treatment. The use of a temporary pacemaker for patients who develop bradycardia during general anesthesia is controversial. Profound bradycardia during eye surgery is a potentially serious event. In clinical practice this oculocardiac reflex (OCR) is most often encountered during squint surgery. Atropine premedication in the patients of squint surgery under general anesthesia definitely obtunds OCR and prevents any untoward effects of dysrhythmias during eye surgery.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Circuit of choice for spontaneous ventilation is?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Mapleson A&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Mapleson B&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Mapleson C&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Mapleson D&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Mapleson A&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Mapleson A Mapleson A circuit is also known as Magill’s circuit. Advantages Best circuit for spontaneous respiration as no rebreathing occurs with adequate flows. Less fresh gas flow is required during spontaneous respiration. Disadvantages Wastage of gases. Theatre pollution by Magill circuit. Mechanical ventilators should not be used with this circuit because the entire system becomes dead space.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Most common nerve used for monitoring in anesthesia is?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Facial nerve&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Median nerve&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Radial nerve&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Ulnar nerve&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Ulnar nerve&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ulnar nerve Adductor pollicis muscle supplied by ulnar nerve is most commonly utilized muscle for neuromuscular monitoring. Facial nerve stimulation of orbicularis oculi is also very commonly used. Neuromuscular monitoring , also known as train of four monitoring is a technique used during recovery from the application of general anesthesia to objectively determine how well a patient&#x27;s muscles are able to function. It involves the application of electrical stimulation to nerves and recording of muscle response using, for example, an acceleromyograph. The diaphragm, rectus abdominis, laryngeal adductors and orbicularis oculi muscles recover from neuromuscular block- age earlier than adductor pollicis.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Murphy’s eye is a part of?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Endoscope&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Endotracheal tubes&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Ryle&#x27;s tube&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;LMA&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Endotracheal tubes&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Endotracheal tubes Endotracheal tubes are used to establish and maintain airway patency, prevent aspiration into the lungs, i.e. &#x27;secure&#x27; the air- way, and allow mechanical ventilation. Most endotracheal tubes today are constructed of polyvinyl chloride, but specialty tubes constructed of silicone rubber, latex rubber, or stainless steel are also widely available. Most tubes have an inflatable cuff to seal the trachea and bronchial tree against air leakage and aspiration of gastric contents, blood, secretions, and other fluids. Uncuffed tubes are also available, though their use is limited mostly to pediatric patients (in small children, the cricoid cartilage, the narrowest portion of the pediatric airway, often provides an adequate seal for mechanical ventilation). Tubes larger than 6 mm ID usually have an inflatable cuff. Originally made from red rubber, most modern tubes are made from polyvinyl chloride. Those placed in a laser field may be flexometallic. Double-lumen endobronchial tubes for thoracic surgery allow single-lung ventilation while the other lung is collapsed to make surgery easier. Another type of endotracheal tube has a small second lumen opening above the inflatable cuff which can be used for suction of the nasopharyngeal area and above the cuff to aid extubation (removal). This allows suctioning of secretions which sit above the cuff which helps reduce the risk of chest infections in long-term intubated patients. Its different parts are:&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Modified Mallampati grading is used in assessment of?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Difficult intubation&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Airway obstruction&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Death due to aspiration&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Intubation&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Difficult intubation&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Difficult intubation Mallampati scoring is used for assessing difficulty during intubation, its grades are: Modified Mallampati scoring Class I: Soft palate, uvula, fauces, pillars visible. Class II: Soft palate, uvula, fauces visible. Class III: Soft palate, base of uvula visible. Class IV: Only hard palate visible.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Trilene is degraded by?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Enzymatic degradation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Non enzymatic degradation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Chemical degradation&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;None of the above&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Chemical degradation&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Chemical degradation Trilene: It is a clear non-flammable liquid with a sweet smell. It was used as a volatile anesthetic and as an inhaled obstetrical analgesic. It is a potent analgesic. Soda lime produces toxic product dichloroacetylene which cause nerve palsies and produce phosgene gas along with it. Most common involved nerve is 5th. S/E is nausea and vomiting.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;µ (mu) receptors are responsible for all actions except:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Analgesia&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Respiratory depression&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Sedation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Diuresis&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Diuresis&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Diuresis Opioids don’t cause diuresis rather they cause urinary retention.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Opioid receptors are of 4 types - μ , κ , δ , and Nociceptin μ- further divided into μ 1 and μ 2 μ1 – Analgesia, Bradycardia, sedation, Miosis, urinary retention, and muscle rigidity μ2 – depression, Constipation, Dependence κ (Kappa) - Analgesia (mainly spinal analgesia but supra spinal also) depression constipation sedation Miosis Dysphoria Hallucination Dependence δ (Delta ) – Analgesia (mainly spinal but supra spinal also) Nociception (Orphanin FQ) Stress response Acupuncture&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;ETCO2 immediately becoming zero is seen in:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Cardiac arrest&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Accidental extubation&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Malignant hyperthermia&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Venous air embolism&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Accidental extubation&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Accidental extubation Capnography is the surest method to confirm intubation. In case of accidental extubation, it will immediately become zero and the graph will become flatline.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- In cardiac arrest, it also becomes zero because there is no blood to carry CO2 from tissues to lungs however it will become zero after a few waveforms (CO2 present in lungs keep on exhaling for few breaths before becoming zero) Option C- In malignant hyperthermia CO2 production increases so rapidly that it can cross even 80-90 mmHg Option D- Pulmonary embolism by air, fat, or thrombus blocks a segment from which CO2 is not exhaled decreasing ETCO2.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 18 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test17" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - NEET PG 2019&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - NEET PG 2019&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                7 Questions | 7 Total Marks | 17 min Duration | ~145.71 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Which of the following is the most common method used to know depth of anaesthesia?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;BIS&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Oesophageal contractility&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Depressed responses&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Hypotension&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. BIS&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;BIS Bispectral index: 1st scientifically validated &amp;amp; commercially available monitor to check depth of anaesthesia. Utilizes many parameters (EEG signals, eye blinks) to calculate depth score. Adequate depth: Score of 45-60. Fully awake state: Score of 100 Completely silent brain: 0. Bispectral Index System Value Depth of Sedation 0 Flat - Line EEG 0 - 40 Deep hypnotic state; memory function lost; increasing burst suppression 40 - 60 Recommended range for general anesthesia 60 - 90 Recommended range for sedation 100 Awake; memory intact&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Anesthetic gas with maximum respiratory irritation:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Halothane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Enflurane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Desflurane&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Sevoflurane&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Desflurane&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Desflurane Desflurane’s induction is irritating and unpleasant and even may manifest as laryngospasm or bronchospasm.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- Halothane as pleasant induction Option B- Enflurane is no more sued in anesthetic practice Option D- Sevoflurane has got the most pleasant induction&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Agent of choice for decreasing hallucinations after ketamine&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Thiopentone&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Propofol&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Morphine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Midazolam&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Midazolam&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Midazolam Benzodiazepines are not only used to decrease the incidence of vivid reactions like hallucinations, they are the drug of choice for the treatment of vivid reactions. Among Benzodiazepines midazolam is almost always used in a current day practice.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Options: A, B, and C. O pioids, barbiturates, Propofol, and inhalational agents, all have been found to decrease the incidence of hallucinations and emergence of delirium however the most preferred are benzodiazepines.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following is not cardio-depressive?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Propofol&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Thiopentone&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Ketamine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Etomidate&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Etomidate&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Etomidate Etomidate is the most cardiovascular stable agent among IV agents, therefore is the induction agent of choice for cardiac patients and vascular surgeries.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option: A. Propofol can decrease the cardiac output by direct depression of the myocardium and by causing hypotension Option: B. Thiopentone by causing vasodilation can cause hypotension Option: C. Directly acting on the myocardium in the denervated heart it depresses the myocardium but in a person with an intact sympathetic system it stimulates the myocardium by stimulating the sympathetic system.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;IV administration of which anesthetic drug is most painful among the following?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Methohexital&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Ketamine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Propofol&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Etomidate&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Propofol&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Propofol Propofol is prepared in soybean oil therefore injection is painful. The pain of injection can be reduced by mixing it with lignocaine.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option: A . Methohexital is a water-based preparation, so injection is painless Option: B. Ketamine is also a water-based injection therefore injection is painless Option: D. Etomidate is an oil-based preparation therefore injection is painful. However, the incidence of pain with Etomidate is far less as compared to propofol. The painful injection actually has been classified as a minor side effect of Etomidate while the painful injection is considered as a major side effect of Moreover, the new lipid preparation of Etomidate is lesser painful than its old propylene glycol-based preparation&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Ideal inhalational agent:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Halothane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Desflurane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Nitrous oxide&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Xenon&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Xenon&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Xenon Xenon is considered an ideal agent due to the following properties No systemic side effects Lowest blood gas coefficient Good analgesia No ozone-depleting effect on the environment No teratogenicity No second gas or diffusion hypoxia No expansion of air cavities&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A. Halothane is not analgesic, and have systemic side effects like a decrease in cardiac output, hypotension, hepatitis, and respiratory depression therefore cannot be the ideal agent Option B. Desflurane is not analgesic, and have systemic side effect like sympathetic stimulation causing tachycardia, an irritant effect on the respiratory tract therefore cannot be the ideal agent Option C. N2O as ozone-depleting effect on the environment, teratogenic, produces second gas and diffusion hypoxia and expansion of air cavities therefore cannot be an ideal agent&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A 6-year-old child is posted for elective urology surgery under GA. He refuses to allow IV access. The best inhalational agent of choice for induction of anesthesia is:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Sevoflurane&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Halothane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Desflurane&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Isoflurane&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Sevoflurane&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sevoflurane Sevoflurane has the smoothest induction therefore is the inhalational agent of choice for induction in children.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option B- Halothane also has got pleasant induction therefore is can be used as an alternative to Sevoflurane for induction. Options C and D- Desflurane and Isoflurane have got irritating induction, therefore, cannot be used for induction.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Like adults, the preferred method for induction even in children is IV (Propofol) however very often children come to OT without an IV cannula, therefore, induction has to be contemplated with a volatile agent. In case of non-availability of inhalational induction alternative method is intramuscular ketamine.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 17 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test18" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - NEET PG 2020&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - NEET PG 2020&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                5 Questions | 5 Total Marks | 15 min Duration | ~180.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Anesthesia of choice for cesarean section for pregnancy-induced hypertension (PIH):&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Spinal&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Epidural&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Combined spinal epidural (CSE)&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;GA&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Spinal&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Spinal The previous concerns of exaggerated hypotension in PIH patients have been unfounded by recent evidence making spinal to be a safer choice for PIH patients.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option B- Theoretically Epidural has been considered as the technique of choice for PIH patients but practically most often epidural is not feasible for cesarean due to multiple reasons like slow onset (unsuitable for emergencies), patchy block, and inadequate muscle relaxation. Option C- Combined spinal epidural is neither required and almost never used for cesarean section Option D- Giving GA to pregnant patients should be avoided due to the high risk of aspiration. Moreover, associated laryngeal edema in PIH can make intubation become more difficult.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A patient has developed acute biliary colic pain for which an intern has administered an analgesic which has increased the severity of the pain. Which of the following analgesics might have been administered?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Morphine&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Nefopam&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Diclofenac&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Nifedipine&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Morphine&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Morphine Although theoretically morphine may worsen the biliary colic by increasing the tone of sphincter of Oddi however this has been unfounded by current studies. Opioid Medications: Opioid analgesics are generally avoided for colicky pain unless absolutely necessary due to the risk of side effects, dependence, and constipation. They may be considered in severe cases under the supervision of a healthcare provider. Avoiding Certain Medications: Some medications, such as opioids and anticholinergic drugs, can exacerbate colicky pain or underlying conditions. For example, opioids can slow down intestinal motility and worsen pain in conditions like diverticulitis or inflammatory bowel disease.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A 55- year old male patient with h/o HTN on ACE inhibitor and had CABG 4 years back is scheduled for hernia surgery. He has good effort tolerance. Which of the following preop investigations are ordered?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Routine preop evaluation + clinical evaluation&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Routine preop + clinical + stress testing&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Routine preop + clinical + angiography to look for patency&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Routine preop + clinical exam + V/Q scan&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Routine preop evaluation + clinical evaluation&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Routine preop evaluation + clinical evaluation Since the CABG had done 4yr back and patient has good effort tolerance routine preoperative evaluation and clinical evaluation will suffice for scheduling hernia surgery.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A 50-year-old patient with a history of Hypertension and DM developed the following rhythm with blood pressure 90/40 mm of Hg and feeble pulse what is the next step of management?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Iv adenosine&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Iv diltiazem&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;DC cardioversion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Ibutilide&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Iv adenosine&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696577522863-QTDTPYQ044IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Iv adenosine This is supraventricular tachycardia. If the patient is hemodynamically stable, a vagal maneuver may be tried. If no response 6 mg IV adenosine is given. Still, if there is no response 12 mg of IV adenosine is given. Still, if no response other drugs like amiodarone may be tried. However, if the patient is hemodynamically unstable then immediate cardioversion should be done Acute Management (During an SVT Episode) : Vagal Maneuvers: These include techniques like the Valsalva maneuver (forced expiration against a closed airway) and carotid sinus massage (performed by a healthcare professional). These maneuvers can help stimulate the vagus nerve, potentially slowing down the heart rate and terminating the SVT episode . Adenosine: Adenosine is a medication often used in a healthcare setting to terminate SVT. It is administered as a rapid IV push and typically results in a brief pause in the heart rhythm, allowing the sinus node to regain control. Calcium Channel Blockers: Medications like verapamil or diltiazem may be used to slow down the heart rate during an SVT episode. Beta-Blockers : In some cases, beta-blockers like metoprolol or propranolol can be effective in slowing down the heart rate during an SVT episode.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;The following ETCO2 curve depicts:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Spontaneous efforts&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Bronchospasm&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Esophageal intubation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Successful resuscitation&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Spontaneous efforts&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696577522842-QTDTPYQ009IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Spontaneous efforts This graph depicts the spontaneous effort of the patient during control b reathing.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option B- Bronchospasm presents at prolonged phase 2 of graph Option C- Esophageal intubation will present as a flat line on capnography Option D- Successful resuscitation is represented by a normal capnograph&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 15 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test19" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - NEET PG 2021&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - NEET PG 2021&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                5 Questions | 5 Total Marks | 15 min Duration | ~180.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;A young male was given regional anaesthesia with 0.25% bupivacaine after which the patient became unresponsive and pulse become unrecordable. The best management would be:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;CPCR with 20% intralipid&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;CPCR with sodabicarb&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;CPCR with dobutamine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;CPCR with calcium&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. CPCR with 20% intralipid&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;CPCR with 20% intralipid Given question describes the case scenario of bupivacaine toxicity. Cardiac toxicity associated with overdose of intravascular injection of local anesthetic is characterized by hypotension, atrioventricular conduction delay, idioventricular rhythms, and eventual cardiovascular collapse. Although all local anesthetics potentially shorten the myocardial refractory period, bupivacaine avidly blocks the cardiac sodium channels, thereby making it most likely to precipitate malignant arrhythmias. Even levobupivacaine and ropivacaine (single-enantiomer derivatives), developed to ameliorate cardiovascular side effects, still harbor the potential to disrupt cardiac function. Primary therapy remains adherence to proven guidelines—cardiac and SpO2 monitoring, proper availability and dosing of all local anesthetics, immediate means to support ventilation, proper cardiac compressions during CPR, and application of proven advanced life support techniques. Only then should lipid rescue be considered in the therapeutic algorithm. The mechanism by which lipids reverse local anesthetic cardiotoxicity may be increasing clearance from cardiac tissue. This nonspecific, observed extraction of local anesthetics from aqueous plasma or cardiac tissues is termed a “lipid sink.” Another proposed mechanism is that lipids counteract local anesthetic inhibition of myocardial fatty acid oxidation, thereby enabling energy production and reversing cardiac depression. Step to consider after “all standard resuscitation methods fail to re-establish sufficient circulatory stability” would be as follows: 20% Intralipid: Administer 1.5 mL/kg as an initial bolus; the bolus can be repeated 1- 2 times for persistent asystole. Start an infusion at 0.25 mL/kg/min for 30-60 minutes; increase infusion rate up to 0.50 mL/kg/min for refractory hypotension&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;What is the mechanism of action of local anaesthetics?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Block Na+ Channels&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Block K + Channels&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Block Ca2 + Channels&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Block Chloride channels&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Block Na+ Channels&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Block Na+ Channels Local anaesthetics mainly acts by blocking sodium channels. Local anaesthetics may also bind and inhibit calcium, potassium, chloride channels and many other channels. But main action is on Sodium channels. The voltage gated sodium channels exists in 3 states : Resting Activated state and Inactivated state Sodium channels have one larger α Subunit and one or two smaller β subunits. The LA binds to α subunit of sodium channels, thereby preventing their activation and inhibiting influx of sodium.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A 30-year-old male was intubated for surgery. The best method to confirm the position of endotracheal tube is:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;X ray chest&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Auscultation&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Capnography&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Chest expansion&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Capnography&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Capnography Capnography is the surest confirmation of intubation.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Other methods which can be used to confirm intubation are: Chest expansion Mist in endotracheal tube Auscultation – Auscultation is often used to confirm the position of the tube however can mislead; conducted sounds even if the tube is in the esophagus can be misunderstood as breath sounds. X-ray chest: It may be used in ICU however not possible in OT. Moreover, the X-ray chest is also not confirmatory.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Another confirmatory method is Bronchoscopy however Bronchoscopy is not practically possible therefore Capnography is used routinely to confirm the position of endotracheal tube.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;You are doing a lumbar puncture. The last structure to be encountered will be:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Ligamentum flavum&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Dura&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Arachnoid&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Pia&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Arachnoid&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Arachnoid Spinal anesthesia is given in the subarachnoid space. Therefore, the last structure pierced will be an arachnoid.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Structural encountered during spinal anesthesia (posterior to anterior) skin subcutaneous tissue Supraspinous ligament Interspinous ligament Ligament flavum Dura Arachnoid&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;The image below done for Airway management includes:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Head tilt, chin lift&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;In line cervical spine stabilization&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Jaw thrust&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Head extension&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Head tilt, chin lift&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696577480768-QTDTPYQ072IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Head tilt, chin lift Part of pre-intubation and emergency rescue breathing procedures, the head tilt–chin lift maneuver and the jaw-thrust maneuver are manual means to help restore upper airway patency when the tongue occludes the glottis, which commonly occurs in an obtunded or unconscious patient. Relative contraindications: Suspected or actual cervical spine injury Avoid closing mouth or compressing chin soft-tissue Obstructs airway Tilting the head or otherwise moving the neck is contraindicated in a patient with a possible cervical spine injury, but maintaining an airway and ventilation is a greater priority. In the setting of a possible cervical spine injury, the jaw-thrust maneuver, in which the neck is held in a neutral position, is preferred over the head tilt–chin lift maneuver.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 15 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test20" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - NEET PG 2022&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - NEET PG 2022&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                3 Questions | 3 Total Marks | 13 min Duration | ~260.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Which among the following are required in the Cannulation of a newborn baby? 22G Needle 24 Gauge Needle Adhesive Tape 5 ml Syringe Normal Saline Select the correct answer from the given below code:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;1, 3, 4, and 5 is correct&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;2, 3, 4, and 5 is correct&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;2, 3, and 4 is correct&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;All of the above is correct&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. 2, 3, 4, and 5 is correct&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;2, 3, 4, and 5 is correct 22 G cannula is used in children . For newborns either a 24 or 26 G cannula is used. Adhesive plast is required for the fixation of the cannula. 5 ml of syringe and saline is required for flushing the cannula&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Identify the equipment which is commonly using for Covid 19 patients in ICU?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Hudson mask&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Venturi mask&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Non rebreathing mask&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Simple face mask&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Non rebreathing mask&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696577386407-QTDTPYQ005IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Non rebreathing mask This is an oxygen mask with a reservoir. It is a non-rebreathing type of mask as holes at the mask are closed.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Option A- Hudson and Macartney are simple oxygen masks as seen below Option B- Venturi mask can be identified by different colors of venturi devices as shown below Option D- Hudson mask or MacCartney mask are simple oxygen face mask&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Another type of oxygen mask with reservoir is partial rebreather. In partial rebreather, holes at the mask are open allowing some rebreathing.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Identify the nerve being tested for neuromuscular monitoring procedure:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Ulnar&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Radial&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Median&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Metacarpal&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Ulnar&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696577386432-QTDTPYQ011IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Ulnar Due to technical ease and availability of enough space to apply electrodes, adductor pollicis, supplied by the ulnar nerve is most frequently employed for neuromuscular monitoring.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Options B, C, and D - Although theoretically, any nerve muscle unit can be used for neuromuscular monitoring however other adductor pollicis ( or corrugator supercilli and orbicularis oculi) no muscle has been utilized practically.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;As the response in corrugator supercilli, (supplied by facial nerve) corresponds with laryngeal muscles it is considered as ideal muscle for monitoring but since its monitoring is technically very difficult, therefore generally is not used.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 13 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test21" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - NEET PG 2023&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - NEET PG 2023&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                3 Questions | 3 Total Marks | 13 min Duration | ~260.0 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;Identify the maneuver being performed in the given image?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Head tilt, chin lift&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Jaw thrust&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Head extension&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;In line cervical spine stabilization&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Head tilt, chin lift&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696577342569-QTDT042002IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Head tilt, chin lift The maneuver performed in the given image is that of a head-tilt chin-lift. It is an important technique in emergency airway management to open up the airway.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Basic life support (BLS) involves early recognition and management of emergencies such as heart attack, stroke, and foreign body airway obstruction. The sequence of BLS is circulation (chest compression), airway and breathing. The airway is usually obstructed by posterior displacement of the tongue or epiglottis. Procedure : One hand (palm) is placed on the patient&#x27;s forehead, applying pressure to tilt the head back. Simultaneously, the chin is lifted with the forefinger and index finger of the opposite hand. This causes cervical flexion with an atlanto- occipital extension (sniffing position). This lifts the tongue from the back of the throat. Head-tilt chin-lift should not be performed in a patient with suspected cervical injury.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;All patients with a head injury should be considered to be suffering from cervical spine injury until proved otherwise Since the removal of a hard collar is often required for intubation, manual stabilization is preferred over collar stabilization.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;When is the given below position recommended ?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Pulse and respiration normal&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Pulse and respiration both are abnormal&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Pulse normal, respiration abnormal&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Pulse abnormal, respiration normal&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Pulse and respiration normal&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696577342640-QTDT042006IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Pulse and respiration normal This is the left lateral position which is the aspiration prevention position. The patient should be nursed in the l eft lateral position if on assessment it is found that the patient is only unconscious with a normal pulse and breathing, which means, the patient does not require CPR.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options:- Options B, C &amp;amp; D- If either breathing is absent or pulse is absent or both are absent then the patient requires CPR which is done in the supine position.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;What is not done in the given image below?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Intraosseous cannulation for giving IV fluids&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Bone marrow aspiration&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Injection of emergency drugs&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;None of the above&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Bone marrow aspiration&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1696577342670-QTDTPYQ040IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Bone marrow aspiration This is not the bone marrow aspiration procedure.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The intraosseous route is an emergency route that was previously recommended for children less than 6 years of age but now can be used at any age, anything including fluids can be given and is preferred over the endotracheal route. A large bore needle is inserted just below the tibial tuberosity and the drug/fluid is injected directly into the medullary cavity. The rate of absorption of the drug is almost equal to the intravascular route.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 13 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

<div id="test22" class="iframe-container" style="display:none;">
    <iframe srcdoc="&lt;!DOCTYPE html&gt;

&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;meta content=&quot;width=device-width, initial-scale=1.0&quot; nameag=&quot;viewport&quot;/&gt;
&lt;title&gt;Anesthesia - NEET PG 2024&lt;/title&gt;
&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js&quot;&gt;&lt;/script&gt;
&lt;style&gt;
  /* Fix for table overflow in results */
  #results-content {
    overflow-x: auto;
    max-width: 100%;
  }
  
  #results-content table {
    min-width: 100%;
    white-space: nowrap;
  }
      /* Add this to your CSS */
      .overflow-x-auto table {
          min-width: 100%;
          border-collapse: collapse;
      }
      
      .overflow-x-auto th, 
      .overflow-x-auto td {
          padding: 8px 12px;
          border: 1px solid #ddd;
          white-space: nowrap;
      }
      
      .overflow-x-auto th {
          background-color: #f8f8f8;
          font-weight: bold;
      }
        /* Custom styles for enhanced aesthetics and responsiveness */
    .option-btn {
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .option-btn:hover, .option-btn:active {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .option-btn.selected {
        background-color: #2c5282;
        color: white;
    }
    .marked {
        background-color: #f59e0b;
    }
    .progress-bar {
        transition: width 0.5s ease-in-out;
        background: #2c5281;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.8; }
        100% { opacity: 1; }
    }
    .question-nav-btn, .result-nav-btn-grid {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 16px;
        touch-action: manipulation;
        transition: all 0.2s ease;
    }
    .question-nav-btn:hover, .question-nav-btn:active, 
    .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
        transform: scale(1.05);
    }
    .answered {
        background-color: #2c5281;
        color: white;
    }
    .unanswered {
        background-color: #e5e7eb;
    }
    .marked-nav {
        border: 2px solid #f59e0b;
    }
    .video-container, .audio-container {
        display: none;
        position: relative;
    }
    .video-container.active, .audio-container.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    .section-transition {
        transition: opacity 0.3s ease;
    }
    .section-transition.hidden {
        opacity: 0;
        pointer-events: none;
    }
    .result-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
    }
    .result-nav-btn {
        background-color: #374151;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    .result-nav-btn:hover, .result-nav-btn:active {
        background-color: #2d3748;
        transform: scale(1.05);
    }
    .result-nav-btn:disabled {
        background-color: #e5e7eb;
        cursor: not-allowed;
    }
    .error-message {
        color: #ef4444;
        font-weight: bold;
        margin-top: 1rem;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 60px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }

.bg-white.rounded-lg.shadow-md.p-4.md\:p-6 {
      margin-bottom: 50px;
      height: auto;
      display: block;
      margin: 10px auto;
      border-radius: 4px;
      object-fit: contain;
    }
    img {
        max-width: 100%;
        max-height: 400px;
        width: auto;
        height: auto;
        display: block;
        margin: 10px auto;
        border-radius: 4px;
        object-fit: contain;
    }
    
    /* For question images specifically */
    .question_images img,
    .explanation_images img {
        max-height: 350px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    /* Mobile-specific adjustments */
    @media (max-width: 640px) {
        .question-nav-btn, .result-nav-btn-grid {
            width: 38px;
            height: 38px;
            font-size: 14px;
        }
        .nav-panel, .results-nav-panel {
            width: 100%;
            max-width: 100%;
            overscroll-behavior: contain;
        }
        .option-btn {
            padding: 12px;
            font-size: 14px;
        }
        .header-text {
            font-size: 1.5rem;
        }
        .subheader-text {
            font-size: 0.875rem;
        }
        .button-group, .result-nav {
            flex-direction: column;
            gap: 0.5rem;
        }
        .result-nav-btn {
            width: 100%;
            text-align: center;
        }
    }
      img {
            max-height: 300px;
        }
        .question_images img,
        .explanation_images img {
            max-height: 250px;
        }
    }
    .video-placeholder {
        width: 400px;
        height: 300px;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    .play-icon {
        font-size: 40px;
        color: #2c5282;
    }
    .video-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 4px solid #e5e7eb;
        border-top: 4px solid #2c5282;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    body, html {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
    #quiz, #results, #instructions {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
    }
&lt;/style&gt;

&lt;/head&gt;
&lt;body class=&quot;bg-gray-100 font-sans transition-colors duration-300&quot;&gt;
&lt;!-- Header Section --&gt;
&lt;header class=&quot;bg-[#2c5281] text-white p-4 pt-14 shadow-lg&quot;&gt;
&lt;div class=&quot;container mx-auto&quot;&gt;
&lt;h1 class=&quot;text-2xl md:text-3xl font-bold header-text&quot;&gt;Anesthesia - NEET PG 2024&lt;/h1&gt;
&lt;p class=&quot;mt-2 text-sm md:text-base subheader-text&quot;&gt;
                14 Questions | 14 Total Marks | 24 min Duration | ~102.86 sec/question
            &lt;/p&gt;
&lt;/div&gt;
&lt;/header&gt;
&lt;!-- Instructions Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 section-transition&quot; id=&quot;instructions&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Instructions&lt;/h2&gt;
&lt;h4 class=&quot;text-gray-800 text-lg font-semibold mt-6 mb-4&quot;&gt;Test Features:&lt;/h4&gt;
&lt;ul class=&quot;space-y-3&quot;&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Multiple choice questions with single correct answers
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Timer-based testing for realistic exam conditions
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mark questions for review functionality
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Comprehensive results and performance analysis
  &lt;/li&gt;
  &lt;li class=&quot;flex items-center gap-3&quot;&gt;
    &lt;i class=&quot;fa-solid fa-circle-check text-green-500&quot;&gt;&lt;/i&gt;
    Mobile-optimized interface for learning on-the-go
  &lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;start-test&quot;&gt;Start Test&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;error-message hidden&quot; id=&quot;error-message&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;


&lt;!-- Quiz Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;quiz&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;!-- Progress Bar --&gt;
&lt;div class=&quot;w-full bg-gray-200 rounded-full h-3 mb-4&quot;&gt;
&lt;div class=&quot;progress-bar h-3 rounded-full&quot; id=&quot;progress-bar&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Question Header --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center mb-4&quot;&gt;
&lt;h2 class=&quot;text-lg font-semibold&quot; id=&quot;question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h2&gt;
&lt;p class=&quot;text-lg font-semibold mt-2 md:mt-0&quot; id=&quot;timer&quot;&gt;Time Remaining: &lt;span&gt;00:00&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Question Content --&gt;
&lt;div class=&quot;mb-6&quot; id=&quot;question-content&quot;&gt;
&lt;p class=&quot;text-gray-800 mb-4&quot; id=&quot;question-text&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;flex flex-wrap gap-4 mb-4&quot; id=&quot;question-images&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;space-y-3&quot; id=&quot;options&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!-- Navigation Buttons --&gt;
&lt;div class=&quot;flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4&quot;&gt;
&lt;div class=&quot;flex gap-2 w-full md:w-auto&quot;&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;previous-btn&quot;&gt;Previous&lt;/button&gt;
  &lt;button class=&quot;bg-[#2c5281] text-white px-4 py-3 w-full md:w-32 h-14 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-btn&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;flex items-center gap-2&quot;&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;mark-review&quot;&gt;
    Review
    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;h-5 w-5&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot;&gt;
      &lt;path d=&quot;M10 2a1 1 0 00-1 1v14l3.293-3.293a1 1 0 011.414 0L17 17V3a1 1 0 00-1-1H10z&quot; /&gt;
    &lt;/svg&gt;
  &lt;/button&gt;
  &lt;button class=&quot;bg-transparent text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-100 transition flex items-center gap-1&quot; id=&quot;nav-toggle&quot;&gt;
    Question 🧭
  &lt;/button&gt;
  &lt;button class=&quot;bg-green-500 text-white px-6 py-3 w-44 h-14 rounded-lg hover:bg-green-600 transition w-full md:w-auto&quot; id=&quot;submit-test&quot;&gt;Submit Test&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Results Section --&gt;
&lt;section class=&quot;container mx-auto px-4 md:px-6 pt-4 md:pt-6 pb-1 hidden section-transition&quot; id=&quot;results&quot;&gt;
&lt;div class=&quot;bg-white rounded-lg shadow-md p-4 md:p-6&quot;&gt;
&lt;h2 class=&quot;text-2xl font-semibold mb-4&quot;&gt;Anaesthesia Machine - Results&lt;/h2&gt;
&lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-4 mb-6&quot;&gt;
&lt;p&gt;&lt;strong&gt;Correct:&lt;/strong&gt; &lt;span id=&quot;correct-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wrong:&lt;/strong&gt; &lt;span id=&quot;wrong-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unanswered:&lt;/strong&gt; &lt;span id=&quot;unanswered-count&quot; class=&quot;text-[#000000]-500&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Marked for Review:&lt;/strong&gt; &lt;span id=&quot;marked-count&quot; class=&quot;text-[#000000]&quot;&gt;0&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h3 class=&quot;text-lg font-semibold mb-4&quot; id=&quot;result-question-number&quot;&gt;Question &lt;span&gt;1&lt;/span&gt; of 4&lt;/h3&gt;
&lt;div class=&quot;space-y-6&quot; id=&quot;results-content&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;result-nav&quot;&gt;
&lt;button aria-label=&quot;Previous question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; disabled=&quot;&quot; id=&quot;prev-result&quot;&gt;Previous&lt;/button&gt;
&lt;button aria-label=&quot;Toggle results navigation panel&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;results-nav-toggle&quot;&gt;Result 🧭&lt;/button&gt;
&lt;button aria-label=&quot;Next question result&quot; class=&quot;result-nav-btn bg-[#2c5281] text-white px-6 py-2 rounded-lg hover:bg-[#2c5281] transition&quot; id=&quot;next-result&quot;&gt;Next&lt;/button&gt;
&lt;/div&gt;
&lt;div class=&quot;mt-6 flex space-x-4 button-group md:flex-row flex-col&quot;&gt;
&lt;button class=&quot;bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition&quot; id=&quot;take-again&quot;&gt;Take Again&lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/section&gt;

&lt;!-- Exit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;exit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Leave Test?&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;Your progress will be lost if you leave this page. Are you sure you want to exit?&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;continue-test&quot;&gt;No, Continue&lt;/button&gt;
      &lt;button class=&quot;bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition&quot; id=&quot;exit-test&quot;&gt;Yes, Exit&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Submit Confirmation Modal --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 hidden&quot; id=&quot;submit-modal&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white rounded-lg p-6 max-w-sm w-full&quot;&gt;
    &lt;h2 class=&quot;text-xl font-semibold mb-4&quot;&gt;Confirm Submission&lt;/h2&gt;
    &lt;p class=&quot;text-gray-700 mb-2&quot;&gt;You have attempted &lt;span id=&quot;attempted-count&quot;&gt;0&lt;/span&gt; of 4 questions.&lt;/p&gt;
    &lt;p class=&quot;text-gray-700 mb-4&quot;&gt;&lt;span id=&quot;unattempted-count&quot;&gt;0&lt;/span&gt; questions are unattempted.&lt;/p&gt;
    &lt;div class=&quot;flex justify-end space-x-4&quot;&gt;
      &lt;button class=&quot;bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition&quot; id=&quot;cancel-submit&quot;&gt;Cancel&lt;/button&gt;
      &lt;button class=&quot;text-white px-4 py-2 rounded-lg hover:bg-[#1a365d] transition&quot; style=&quot;background-color: #2c5281;&quot; id=&quot;confirm-submit&quot;&gt;Submit Test&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Quiz Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 nav-panel hidden overflow-y-auto&quot; id=&quot;nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Questions Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Results Navigation Panel --&gt;
&lt;div class=&quot;fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 results-nav-panel hidden overflow-y-auto&quot; id=&quot;results-nav-panel&quot; style=&quot;align-items: flex-start; padding-top: 33vh;&quot;&gt;
  &lt;div class=&quot;bg-white shadow-lg p-4 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto&quot;&gt;
    &lt;h2 class=&quot;text-lg font-semibold mb-4&quot;&gt;Results Navigation&lt;/h2&gt;
    &lt;div class=&quot;mb-4&quot;&gt;
      &lt;select class=&quot;w-full p-2 border rounded-lg text-gray-700&quot; id=&quot;results-nav-filter&quot;&gt;
        &lt;option value=&quot;all&quot;&gt;All Questions&lt;/option&gt;
        &lt;option value=&quot;answered&quot;&gt;Answered&lt;/option&gt;
        &lt;option value=&quot;unanswered&quot;&gt;Unanswered&lt;/option&gt;
        &lt;option value=&quot;marked&quot;&gt;Marked for Review&lt;/option&gt;
      &lt;/select&gt;
    &lt;/div&gt;
    &lt;div class=&quot;grid grid-cols-5 gap-2 md:gap-3&quot; id=&quot;results-nav-grid&quot;&gt;&lt;/div&gt;
    &lt;button class=&quot;mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full&quot; id=&quot;close-results-nav&quot;&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- JavaScript Logic --&gt;

&lt;script&gt;
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog(&quot;Attempting to parse questions_json&quot;);
            questions = [{&quot;text&quot;: &quot;A patient undergoing surgery in the prone position is maintained on mechanical ventilation with PEEP. What is the significance of using PEEP in this scenario?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Prevents alveoli collapse and atelectasis of lung&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Decreases inspiratory pressure&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Increases venous return and maintains cardiac output&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Reduces CO2 in alveoli&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Prevents alveoli collapse and atelectasis of lung&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Prevents alveoli collapse and atelectasis of lung In the scenario where a patient is undergoing surgery in the prone position and is on mechanical ventilation with Positive End-Expiratory Pressure (PEEP), the significance of using PEEP is primarily to: Prevents alveoli collapse and atelectasis of the lung&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;PEEP works by keeping the alveoli open at the end of expiration , which helps prevent alveolar collapse (atelectasis). This is particularly important in the prone position , where the weight of the body and the positioning can cause compression of certain lung areas, increasing the risk of atelectasis. PEEP helps maintain adequate oxygenation by ensuring that more alveoli are available for gas exchange , especially in dependent areas of the lung . PEEP works primarily by keeping alveoli open at the end of exhalation, preventing atelectasis , improving oxygenation , and increasing functional residual capacity.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for incorrect options: - Option: B. Decreases inspiratory pressure: This is incorrect. PEEP does not decrease inspiratory pressure; it can actually increase the pressure needed to deliver a breath. Option: C. Increases venous return and maintains cardiac output: This is incorrect. PEEP can reduce venous return by increasing intrathoracic pressure, which can, in turn, decrease cardiac output, especially at higher levels. Option: D. Reduces CO2 in alveoli: This is incorrect. PEEP primarily affects oxygenation by preventing alveolar collapse and promoting recruitment of alveoli, but it does not directly reduce CO2 levels in the alveoli. CO2 elimination depends more on ventilation (tidal volume and respiratory rate).&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following statements are true about eutectic mixture of local anesthetic (EMLA)?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;1gm of 0.5% of cream contains 50mg lignocaine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Methemoglobinemia is a side effect&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;It is an unequal mixture&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;It is made of Lignocaine and ropivacaine&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. Methemoglobinemia is a side effect&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732183236872-QT81IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Methemoglobinemia is a side effect Methemoglobinemia can occur as a rare side effect of EMLA, primarily due to prilocaine. Prilocaine can be metabolized to o-toluidine, which can oxidize hemoglobin to methaemoglobin, impairing oxygen transport. EMLA is a topical anesthetic cream used to numb the skin before certain procedures. It consists of a eutectic mixture of lidocaine (lignocaine) and prilocaine, not ropivacaine, and has specific properties and side effects.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Various combination of anesthetic agent: EMLA Cream Components: Lidocaine (2.5%) + Prilocaine (2.5%) Uses: Topical anesthesia for minor surgical procedures, IV catheter insertion, and painful skin conditions. Lidocaine Cream Components: Lidocaine (5-10%) Uses: Used for localized pain relief in minor skin procedures, burns, insect bites, and hemorrhoids . TAC Solution Components: Tetracaine (0.5%) + Adrenaline (1:1000) + Cocaine (11.8%) Uses: Topical anesthesia for skin and mucosal procedures; effective in numbing the area quickly. Lidocaine and Benzocaine Ointment Components: Lidocaine (2-5%) + Benzocaine (5-20%) Uses: Relief from pain due to skin irritations, minor burns, and insect bites. Lidocaine and Menthol Gel Components: Lidocaine (2-5%) + Menthol (1-5%) Uses: Provides cooling and analgesic effects for muscle and joint pain . Pliaglis Components: Lidocaine (7%) + Tetracaine (7%) Uses: A peelable topical anesthetic for superficial skin procedures. Bupivacaine Patch (Qutenza) Components: Capsaicin (8%) Uses: Topical application for neuropathic pain, particularly postherpetic neuralgia. AneCream Components: Lidocaine (4%) + Tetracaine (0.5%) + Adrenaline (1:1000) Uses: Provides topical anesthesia for dermatological procedures. Zingo Components: Lidocaine (4%) delivered via a device that administers a fast-acting delivery system. Uses: Used for pain relief during needle procedures in children. Combination Sprays Examples: Lidocaine + Epinephrine Spray: For mucosal anesthesia, used in dental procedures or endoscopic interventions. Benzocaine + Lidocaine + Prilocaine Spray: Often used in dermatological or minor surgical settings.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - ● Option: A. \&quot;1gm of 0.5% of cream contains 50mg lignocaine\&quot; False: EMLA is typically a 5% cream, containing 2.5% lidocaine and 2.5% prilocaine. Therefore, 1 gram of EMLA cream would contain 25 mg of lignocaine and 25 mg of prilocaine, not 50 mg of lignocaine. ● Option: C. \&quot;It is an unequal mixture\&quot; True: EMLA is indeed a 1:1 eutectic mixture of lidocaine (2.5%) and prilocaine (2.5%), forming a cream that allows for better skin penetration. ● Option: D. \&quot;It is made of Lignocaine and ropivacaine\&quot; False: EMLA is made of lidocaine (lignocaine) and prilocaine, not ropivacaine.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;An anesthetist used the airway device shown in the image given below on a patient. Which among the following statements is true regarding the adjunct?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;It can cause damage to the teeth&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;It can be used in unconscious patients&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;It does not cause laryngospasm&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;It can be safely used in facial trauma cases&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;B. It can be used in unconscious patients&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732183236918-QT87IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;It can be used in unconscious patients This device is used to maintain an open airway by preventing the tongue from covering the epiglottis, which can obstruct airflow in unconscious or sedated patients. An oropharyngeal airway (OPA) is primarily used in unconscious patients to keep the airway open and prevent the tongue from obstructing the airway. Here&#x27;s why it is best suited for unconscious patients:&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;1. Prevents Tongue Obstruction Mechanism: In unconscious patients, the tongue can relax and fall back, blocking the airway. An OPA holds the tongue away from the soft tissues at the back of the throat, maintaining airway patency. Benefit: This ensures that the airway remains open, allowing for better oxygenation and ventilation. 2. Avoids Gag Reflex in Unconscious Patients Reason: Conscious or semi-conscious patients have an active gag reflex. Inserting an OPA can stimulate this reflex, leading to vomiting, choking, or even aspiration. In unconscious patients, the gag reflex is diminished or absent, making it safer to insert the OPA without causing distress or complications. 3. Used During Anesthesia or Emergencies Situations: OPAs are commonly used in unconscious patients during general anesthesia, emergency situations like resuscitation, or in those who have reduced levels of consciousness (e.g., due to head injury or overdose). Role: In these settings, the OPA helps maintain an open airway until a more definitive airway (e.g., endotracheal tube) can be placed or until the patient regains consciousness.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: A. It Can Cause Damage to the Teeth: True, if not inserted carefully. Option: C. It Does Not Cause Laryngospasm: False, as it can trigger laryngospasm if inserted improperly or in semi-conscious patients. Option: D. It Can Be Safely Used in Facial Trauma: False, OPAs should generally be avoided in facial trauma cases.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;In the following condition as shown in the radiograph, which of the following procedures would be difficult to perform?\&quot;&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Nasogastric tube insertion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Laryngeal mask airway&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Tracheostomy&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Indirect laryngoscopy&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Tracheostomy&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732183236951-QT88IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Tracheostomy The chest X-ray shows a large left-sided pleural effusion, which can cause displacement of mediastinal structures and impact respiratory function. In this context, let&#x27;s analyze why tracheostomy would be the most difficult procedure. A large pleural effusion can make tracheostomy more difficult due to altered anatomy, mediastinal shift, and possible respiratory instability, all of which increase the risk during the procedure.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Contraindications and Situations Where Tracheostomy is Difficult: Though there are no absolute contraindications, there are relative contraindications and difficult scenarios, including: Severe Obesity: A thick neck due to severe obesity makes identifying landmarks for tracheostomy difficult, and it can complicate both the procedure and post-op care. Bleeding Disorders: Patients with coagulopathies or those on anticoagulation therapy (e.g., warfarin, heparin) are at risk for severe bleeding during and after the procedure. Neck Tumors: Large neck masses or cancers may obstruct the trachea or distort the anatomy, making the procedure technically challenging. High Intrathoracic Pressure or Mediastinal Shift: In cases like pleural effusion or pneumothorax, the trachea may be displaced due to a mediastinal shift, which makes it harder to identify the correct anatomical structures and increases the risk of complications. Infection at the Site: Active skin infections or abscesses at the tracheostomy site increase the risk of sepsis and wound complications. Unstable Cervical Spine: In cases of trauma where cervical spine stability is a concern, neck manipulation during the procedure can risk spinal cord injury. Morbid Anatomy: Congenital malformations (e.g., tracheal stenosis) or abnormal neck anatomy (e.g., due to previous surgeries or radiation) make performing the procedure more difficult. Severe Emphysema or Bullae: Patients with conditions such as bullous emphysema may have fragile lung tissue, and performing a tracheostomy could lead to complications like pneumothorax.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: A. Nasogastric tube insertion: This is generally not affected by pleural effusion. There is no significant interference with the esophagus or stomach from pleural fluid accumulation. Option: B. Laryngeal mask airway (LMA): An LMA can be used in patients with pleural effusion since it primarily addresses airway management. Pleural effusions typically do not directly interfere with the placement of an LMA. Option: D. Indirect laryngoscopy: This procedure involves visualizing the larynx and is not typically affected by pleural effusion. The anatomy of the airway is usually unaffected by fluid in the pleural space, so indirect laryngoscopy can still be performed.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Which of the following agents is appropriate for reversing vecuronium when renal function tests are normal?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Physostigmine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Rivastigmine&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Sugammadex&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Succinylcholine&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Sugammadex&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sugammadex The appropriate agent for reversing vecuronium, especially when renal function tests are normal, is Sugammadex. Sugammadex: A selective relaxant binding agent that rapidly reverses the effects of steroidal neuromuscular blockers like vecuronium and rocuronium. It works by encapsulating the neuromuscular blocker, making it inactive, and is especially effective in patients with normal renal function.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sugammadex Mechanism of Action (MOA) Selective Binding: Sugammadex is a modified cyclodextrin that selectively binds to neuromuscular blocking agents (NMBAs) like vecuronium and rocuronium. Encapsulation: Once it binds to these agents, Sugammadex forms a stable complex that inactivates the NMBAs, thereby reversing their neuromuscular blocking effects. This process reduces the amount of free NMBA available to bind to nicotinic receptors at the neuromuscular junction. ● Indications: Reversal of Neuromuscular Blockade: Sugammadex is primarily indicated for the rapid reversal of moderate to deep neuromuscular blockade induced by: Vecuronium Rocuronium It is especially useful in situations where quick recovery from neuromuscular blockade is desired, such as before extubation in surgical procedures. Side Effects: While Sugammadex is generally considered safe, potential side effects include: Hypersensitivity Reactions: Allergic reactions can occur, including anaphylaxis. Bradycardia: A decrease in heart rate may occur, particularly during administration. Nausea and Vomiting: Experience gastrointestinal symptoms. Increased Risk of Prolonged Neuromuscular Blockade: In patients who receive higher doses or have certain pre-existing conditions, there is risk of prolonged effects.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: A. Physostigmine: An anticholinesterase used primarily for reversing central nervous system effects of anticholinergic drugs; not typically used for neuromuscular blockade reversal. Option: B. Rivastigmine: Also an anticholinesterase, primarily used in the treatment of Alzheimer&#x27;s disease and other dementias, not for neuromuscular blockade reversal. Option: D. Succinylcholine: A depolarizing neuromuscular blocker used for intubation, not a reversal agent.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A COVID-19 patient admitted to the ICU on mechanical ventilation suddenly develops hypoxia. The patient has decreased breath sounds on the left side and increased intrathoracic pressure. What is the most likely diagnosis?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Pneumothorax&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Left-Sided Pleural Effusion&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Acute Respiratory Distress Syndrome&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Left-Sided Pneumonia&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Pneumothorax&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732183236959-QT93IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Pneumothorax The most likely diagnosis in this scenario is Pneumothorax. Sudden Hypoxia : This suggests an acute change in the patient’s respiratory status. Decreased Breath Sounds on the Left Side: This finding indicates that airflow may be compromised on that side, which is characteristic of a pneumothorax where air enters the pleural space and collapses the lung. Increased Intrathoracic Pressure: This is also consistent with pneumothorax, particularly tension pneumothorax, where trapped air in the pleural cavity increases pressure, further compromising lung function and leading to respiratory distress.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Types of Pneumothorax Primary Spontaneous Pneumothorax (PSP) Cause: Occurs without an obvious cause, often in tall, young males. Symptoms: Sudden onset of dyspnea and sharp unilateral chest pain; may have decreased breath sounds on examination. Secondary Spontaneous Pneumothorax (SSP) Cause: Occurs in patients with underlying lung disease (e.g., COPD, asthma, cystic fibrosis). Symptoms: Similar to PSP but may be accompanied by a more significant underlying condition, leading to potentially more severe symptoms. Traumatic Pneumothorax Cause: Results from chest trauma, such as fractures, stab wounds, or invasive procedures (e.g., thoracentesis). Symptoms: Sudden dyspnea, chest pain, and possible signs of shock or hemothorax, depending on the severity of the trauma. Tension Pneumothorax Cause: A severe form of pneumothorax where air enters the pleural space and cannot escape, leading to increased intrathoracic pressure. Symptoms: Severe respiratory distress, hypotension, tracheal deviation away from the affected side, and hyper-resonance on percussion. It is a medical emergency. Treatment Options for pneumothorax: ● Observation: ○       Indicated For: Small, asymptomatic primary spontaneous pneumothorax. ● Needle Decompression: ○       Indicated For: Tension pneumothorax. ○       Management: A large-bore needle is inserted into the second intercostal space in the midclavicular line on the affected side to release trapped air. ● Chest Tube Insertion (Thoracostomy): ○       Indicated For: Larger pneumothorax, secondary spontaneous pneumothorax, or if symptoms persist. ○       Management: A chest tube is inserted to allow continuous drainage of air from the pleural space. ● Surgery: ○       Indicated For: Recurrent pneumothorax or when conservative measures fail. ○       Management: Procedures may include pleurodesis (to adhere the lung to the chest wall) or surgical repair of the underlying lung pathology.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: B. Left-Sided Pleural Effusion: While this can cause decreased breath sounds, it would more likely present with dullness to percussion and gradual onset of symptoms rather than sudden hypoxia. Option: C. Acute Respiratory Distress Syndrome (ARDS): This condition typically does not present with unilateral decreased breath sounds; it usually affects both lungs. Option: D. Left-Sided Pneumonia: This could cause hypoxia and decreased breath sounds, but it is less likely to be associated with the acute increase in intrathoracic pressure described in the scenario.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Extraedge:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Beck’s Triad&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A 3-year-old child presents with drowsiness and refusal to feed. On examination, the child is in a stuporous state. The ECG is shown below. What is the next best step in the management of this patient?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Immediate synchronized cardioversion @1 joule/kg&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Defibrillate, check rhythm and then start CPR&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Defibrillate followed by CPR for 2min, and check rhythm&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Stop CPR and do cardioversion at 2 joules/kg&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Defibrillate followed by CPR for 2min, and check rhythm&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732183236972-QT97IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Defibrillate followed by CPR for 2min, and check rhythm In this scenario involving a 3-year-old child presenting with drowsiness, refusal to feed, and stupor, the key considerations are the child’s altered mental status and the implications The ECG findings are critical in determining the appropriate management. Defibrillate followed by CPR for 2 minutes, and check rhythm : Indication for Defibrillatio n: If the ECG shows a shockable rhythm (e.g., ventricular fibrillation or pulseless ventricular tachycardia), immediate defibrillation is indicated. The child’s altered mental status may be a result of inadequate perfusion, and addressing the underlying rhythm disturbance is crucial. CPR: After defibrillation , performing CPR for 2 minutes allows time for the heart to potentially regain a normal rhythm while providing essential circulation to vital organs. Check Rhythm: After 2 minutes of CPR , reassessing the rhythm is important to determine the next steps, such as further defibrillation or advanced cardiac life support interventions.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;1. Atrial Fibrillation (AF) Characteristics: Irregularly Irregular Rhythm: The heartbeat is irregular and often rapid. Absence of P Waves: Instead of distinct P waves, there are fibrillatory waves (f-waves) on the ECG. Variable Ventricular Response: The QRS complexes are usually narrow but can vary in rate. Clinical Significance: Can lead to increased risk of thromboembolism and stroke. Ecg of Atrial fibrillation: 2. Ventricular Fibrillation (VF) Characteristics: Chaotic, Disorganized Electrical Activity: The heart muscle is quivering rather than contracting effectively. No Effective Heartbeat: This leads to loss of effective blood circulation. ECG Appearance: A rapid, erratic waveform with no identifiable QRS complexes or P waves. Clinical Significance: A life-threatening emergency requiring immediate defibrillation. 3. Atrial Flutter Characteristics: Regular Rhythm: Often presents with a regular rhythm, typically at rates of 240-340 beats per minute. Sawtooth Pattern: The characteristic \&quot;sawtooth\&quot; pattern in leads II, III, and aVF is referred to as \&quot;F-waves.\&quot; P Waves: Distinct, sawtooth P waves (F-waves) are visible on ECG. Clinical Significance: Can lead to similar complications as atrial fibrillation, including thromboembolism. 4. Ventricular Flutter Characteristics: Rapid Ventricular Rate: Typically between 150-250 beats per minute. Uniform QRS Complexes: The QRS complexes appear wide and similar in shape, often without discernible P waves. Can Degenerate into VF: It is often considered a precursor to ventricular fibrillation. Clinical Significance: Requires immediate intervention, often resulting in rapid deterioration. 5. Junctional Fibrillation Characteristics: Irregular Rhythm: Similar to atrial fibrillation but originates from the AV junction. P Waves: Absent or inverted; the rate is usually slower than in atrial fibrillation. Narrow QRS Complexes: Typically presents with narrow QRS complexes. Clinical Significance: Often associated with underlying heart disease but less commonly results in severe symptoms.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: A. Immediate synchronized cardioversion @1 joule/kg : Synchronized cardioversion is indicated for stable patients with specific arrhythmias (e.g., atrial fibrillation) but not typically for an unstable patient in stupor. Option: B. Defibrillate, check rhythm and then start CPR: This approach does not prioritize CPR, which is critical for maintaining circulation, especially if the child is in cardiac arrest. Option: D. Stop CPR and do cardioversion at 2 joules/kg: This would not be appropriate if the child is in a stuporous state, suggesting hemodynamic instability or cardiac arrest.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A patient is undergoing implant surgery for his upper limb. On giving general anaesthesia he develops tachycardia, sudden raise in body temperature and rigidity of muscles. What drug is most likely to have caused this?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Propofol&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Etomidate&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Nitrous oxide&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Halothane&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Halothane&quot;, &quot;question_images&quot;: [], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Halothane In the clinical scenario given above, the development of tachycardia and muscle rigidity soon after administration of anesthetic agents can be due to malignant hyperthermia. Halothane is the anesthetic agent associated with this condition.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Malignant hyperthermia is a rare genetic hypermetabolic disease of the muscle. It occurs due to a mutation of the gene for the ryanodine receptor (Ryr 1), located on chromosome 19. It is an ion channel responsible for calcium release from the sarcoplasmic reticulum. The symptoms develop when the patient is exposed to suxamethonium/succinylcholine or other inhaled anesthetics like halothane, isoflurane, sevoflurane, desflurane, etc. The mutated ryanodine receptor leads to a sudden release of calcium from the sarcoplasmic reticulum of the skeletal muscle. This uncontrolled increase in intracellular calcium removes the inhibition of troponin, resulting in sustained muscle contraction, and increasing adenosine triphosphatase (ATPase) activity. This results in an uncontrolled hypermetabolic state with increased oxygen consumption and CO2 production, producing severe lactic acidosis and hyperthermia. Treatment is to discontinue the triggering agents ie. succinylcholine followed by administration of 100% oxygen. Metabolic acidosis and hyperkalemia need to be corrected. Hyperthermia must be controlled by cooling the patient. Dantrolene sodium is the drug of choice. It is given at a dose of 2.5 mg/kg intravenously and can be repeated every 5-10 minutes till the attack subsides.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: A. Propofol: An intravenous anesthetic with rapid onset and recovery, often preferred for induction due to minimal postoperative nausea. Unlike halothane, it lacks analgesic effects and can cause significant hypotension and respiratory depression. Option: B. Etomidate: An IV agent providing stable hemodynamics, ideal for patients at risk of hypotension. Unlike halothane, it lacks analgesia and causes adrenal suppression, making it unsuitable for prolonged anesthesia. Option: C. Nitrous Oxide: An inhaled anesthetic gas with mild anesthetic and analgesic properties, often used in combination with other agents. Less potent than halothane, it provides analgesia but can cause air space expansion issues.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Table:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;#MANTRA Summary of anaesthetic properties Drug Analgesia Induction Muscle relaxation Thiopentone Antanalgesic at subanaesthetic doses Smooth Nil Propofol No analgesia Smooth Nil Ketamine Very potent analgesic Not smooth Increases muscle tone Benzodiazepines No analgesia Not used for induction Centrally acting muscle relaxants Opioids Analgesic Not used for induction Increases muscle tone Dexmedetomidine No analgesia Not used for induction Nil&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;This recovery position is appropriate for:&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Unresponsive patient, pulse and breathing absent&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Responsive patient, pulse and breathing present&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Unresponsive patient, pulse and breathing present&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Unresponsive with pulse, without breathing&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;C. Unresponsive patient, pulse and breathing present&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732270446459-QT47IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Unresponsive patient, pulse and breathing present The position illustrated in the picture is known as the recovery position, and it is used in the management of patients who are unresponsive but with pulse present and breathing present. The recovery position can help prevent complications such as aspiration and airway obstruction in unconscious individuals. Additionally, it is crucial to continuously monitor the patient&#x27;s airway, breathing, and circulation while in recovery and seek immediate medical assistance. An unresponsive patient who is breathing spontaneously in the supine position is at risk of airway obstruction from their tongue, mucus, vomit, etc. A modified lateral position is used and the following 6 principles are considered while choosing which variation of recovery position to use.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The suggested approach: Check Responsiveness and Breathing : Ensure the person has a clear airway and is breathing normally. Monitor for any signs of compromised breathing or changes in pulse. Positioning : Place the person in the recovery position (on their side with the mouth open and head tilted slightly downward) to help maintain an open airway and prevent aspiration if they vomit. Assess for Possible Causes : Consider common causes of altered mental status, such as hypoglycemia, drug overdose, seizures, or head injury. If available, assess blood sugar, look for medical alert tags, and examine surroundings for clues. Monitor and Seek Help : Call for emergency medical help if needed, and continuously monitor pulse and breathing. Avoid giving anything by mouth, as they may not be able to swallow safely.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: A. Unresponsive with pulse and breathing absent - In this situation, the patient is in cardiac arrest and requires immediate cardiopulmonary resuscitation (CPR), not the recovery position. CPR involves chest compressions and rescue breaths to support circulation and respiration. Option: B. Responsive patient with pulse and breathing present- The patient should be monitored until the emergency response team arrives. Option: D. Unresponsive with pulse present and breathing absent - In this case, the patient is experiencing respiratory arrest. Rescue breathing or bag-valve-mask ventilation should be initiated to support the patient&#x27;s breathing. The recovery position is not indicated in this scenario.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;What is the procedure being done in the image?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Bier Block&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Axillary nerve block&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Median nerve block&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Wrist block&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Bier Block&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732270446680-QT73IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Bier Block The position in the image of a hand with a tourniquet occluded limb shows a Bier Block. IVRA or Bier&#x27;s block involves the intravenous administration of a local anesthetic into a tourniquet-occluded limb. It is used to provide anesthesia for short surgical procedures (&amp;lt;90 minutes) on the limbs.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Types of block: Peripheral Nerve Blocks : Brachial Plexus Block : Used for upper limb surgeries, targeting nerves of the shoulder, arm, and hand. Interscalene Block : Primarily for shoulder and upper arm. Supraclavicular Block : Effective for surgeries on the mid and lower arm. Infraclavicular and Axillary Blocks : Used for the arm, elbow, forearm, and hand. Femoral Nerve Block : Provides anesthesia for anterior thigh, knee, and hip surgeries. Sciatic Nerve Block : Useful for knee, lower leg, and foot surgeries, often paired with femoral block for complete leg coverage. Popliteal Block : Targets the nerves around the knee, helpful for foot and ankle surgeries. Central Neuraxial Blocks : Epidural Block : Administered in the epidural space, commonly used in labor, childbirth, and lower body surgeries. It can be continuous, providing extended anesthesia. Spinal Block : Injected into the subarachnoid space, typically used for shorter surgeries below the umbilicus, such as hip or knee replacements and cesarean sections. Truncal Blocks : Paravertebral Block : Targets nerves emerging from the spinal cord along the thoracic and lumbar spine, often used in thoracic, abdominal, and breast surgeries. Transversus Abdominis Plane (TAP) Block : Provides anesthesia to the anterior abdominal wall for surgeries like hernia repair and cesarean sections. Pectoral Nerve (Pecs) Block : Often used in breast surgeries, this block targets nerves supplying the chest wall.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: B. The axillary nerve block provides anesthesia for short surgical procedures on the hand, wrist, or forearm. It is performed by using an ultrasound-guided needle in the proximal axilla between the tendon of the latissimus dorsi and the teres major. Option: C. Median nerve blocks are used for procedures involving the palmar aspect of the arm or the carpal tunnel. For a median nerve block at the elbow, the probe is placed in the elbow crease over the proximal radius and the anesthetic is injected aiming for the fascial plane between flexor digitorum superficialis and flexor digitorum profundus. Option: D. For a wrist block, the arm is abducted with the hand in supination, following which the anesthetic is infiltrated in the dorsal aspect of the wrist. This is used for short procedures of the wrist and the fingers. Note: Bupivacaine is not used for Biers block. It is the most cardiotoxic local anesthetic. Accidental early deflation of the tourniquet can lead to massive systemic doses of bupivacaine resulting in cardiac arrhythmias and cardiovascular collapse.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;A patient presents with stridor after prolonged intubation. The endoscopic view is shown in the image below. What is the staging system for this condition?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Cotton Meyer&#x27;s&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;AJCC&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Radkowski&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;TNM&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. Cotton Meyer&#x27;s&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732274893050-QT140IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Cotton Meyer&#x27;s This patient presenting with stridor after prolonged intubation most likely has subglottic stenosis post intubation. This condition is staged by the Cotton Meyer&#x27;s grading.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Subglottic stenosis following prolonged intubation is a narrowing of the airway just below the vocal cords (subglottic region), which can lead to difficulty breathing. This condition is often a complication of endotracheal intubation due to the pressure exerted by the tube or cuff on the airway mucosa, leading to injury and scarring. These patients present with stridor, dyspnea, hoarseness or changes in voice, and difficulty in breathing. Diagnosis is by laryngoscopy or bronchoscopy which allows direct visualization of the subglottic area to assess the degree of stenosis. CT or MRI may be used to evaluate the extent of narrowing and identify any underlying structural damage. Treatment can be via endoscopic balloon or mechanical dilation, laser therapy or surgical resection may be needed to remove the stenosis in severe cases. In severe cases, a tracheostomy may be required to bypass the obstructed segment and allow for breathing.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: B. AJCC (American Joint Committee on Cancer): This staging system is widely used for various cancers, combining tumor size, lymph node involvement, and metastasis to assign stages. It provides standardized staging guidelines for treatment planning and prognosis. Option: C. Radkowski Classification: Primarily used for juvenile nasopharyngeal angiofibroma, this system categorizes tumors based on their extent and involvement of surrounding structures. It helps guide surgical approach and treatment decisions. Option: D. TNM (Tumor, Node, Metastasis): This universal cancer staging system assesses tumor size and local invasion (T), lymph node involvement (N), and presence of distant metastasis (M). TNM staging provides a detailed framework for assessing cancer progression and selecting appropriate therapies.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;What is true about the following position?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;High rate of error&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Ideal position for bougie insertion in emergencies&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Ideal position for neurosurgery&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Sniffing position for intubation&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Sniffing position for intubation&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732270447028-QT141IMG1.jpg&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Sniffing position for intubation The above image shows the sniffing position used for intubation, which is the true statement. The sniffing position is a common head and neck alignment technique used during intubation to optimize the view of the glottis for easier insertion of the endotracheal tube.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Highyeild:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;It is achieved by flexing the neck and extending the head, resembling the posture one assumes when sniffing. The position aligns the oral, pharyngeal, and laryngeal axes to provide a straight line of sight, making the glottis more visible during direct laryngoscopy and intubation. Steps of intubation using the sniffing position: Direct laryngoscopy is performed in the sniffing position, with the head elevated 5-10 cm above the surgical table, the cervical spine flexed, and the atlantooccipital joint extended. The epiglottis is lifted up by the tip during laryngoscopy with Miller&#x27;s blade. While performing laryngoscopy, the scope is lifted upwards and never levered over the upper incisors.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Random:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Explanation for other options: - Option: A. The sniffing position is the most commonly used position in anesthesia as it ensures patient safety by ensuring a straight line of sight, allowing for better outcomes of the procedure. Option: B. The sniffing position is not the ideal position for bougie insertion during emergencies as there is concerns for cervical spine trauma in patients in the emergency department. Option: C. The sniffing position is not the typical position for neurosurgery. Depending on the location of the surgery, different head and neck positions are used.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;Following is the image of a normal capnograph. What is true about the segment 3-4?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;Inhalation of fresh gas&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;Exhalation of dead space air&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;Exhalation of mixed gases&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;Alveolar gas and plateau pressure&quot;, &quot;correct&quot;: true}], &quot;correct_answer&quot;: &quot;D. Alveolar gas and plateau pressure&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732270447154-QT161IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Alveolar gas and plateau pressure In a capnographic waveform, the plateau phase corresponds to alveolar air and plateau pressure. The normal waveform has four different phases: Phase I: Inspiratory baseline, represents the CO2-free gas from the airways (anatomical and apparatus dead space). Phase II: Expiratory upstroke, mixing of dead space gas with alveolar gas. Phase III: Alveolar plateau, represents CO2-rich gas from the alveoli. The last of the alveolar gas is sampled to measure ETCO2 Phase 0: Inspiratory downstroke and the beginning of inspiration. Alpha angle: The transition from phase II to III. The alpha angle can be used to assess the ventilation/perfusion of the lung. V/Q mismatches will have an alpha angle greater than 90 degrees. Beta angle: The transition from phase III to 0. The beta angle can be used to assess rebreathing. If rebreathing occurs, the angle is greater than 90 degrees. Phase 0 - Inspiratory downstroke Phase I Inspiratory baseline: dead space Phase II - Expiratory upstroke: mixture of dead space and alveolar gas Phase III Alveolar gas plateau a angle - Transition from phase II to phase III ẞ angle - Transition from phase III to 0&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}, {&quot;text&quot;: &quot;At what pressure does the marked structure open?&quot;, &quot;options&quot;: [{&quot;label&quot;: &quot;A&quot;, &quot;text&quot;: &quot;30-40 cm H2O&quot;, &quot;correct&quot;: true}, {&quot;label&quot;: &quot;B&quot;, &quot;text&quot;: &quot;30-40 mmHg&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;C&quot;, &quot;text&quot;: &quot;10-20 cm H2O&quot;, &quot;correct&quot;: false}, {&quot;label&quot;: &quot;D&quot;, &quot;text&quot;: &quot;10-20 mm Hg&quot;, &quot;correct&quot;: false}], &quot;correct_answer&quot;: &quot;A. 30-40 cm H2O&quot;, &quot;question_images&quot;: [&quot;https://dbmi-data.s3.ap-south-1.amazonaws.com/photos-1732270447158-QT162IMG1.JPG&quot;], &quot;explanation_images&quot;: [], &quot;explanation&quot;: &quot;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;30-40 cm H2O In the image, the marked structure is the adjustable pressure-limiting (APL) valve of Mapleson-C anaesthetic breathing system and it will open at the pressure of 30-40 cm H2O. This valve is designed to release gas when a certain pressure is exceeded to prevent excessive pressure from building up in the patient&#x27;s airway. The APL valve typically opens at pressures of 30-40 cm H2O to allow for safe ventilation without causing barotrauma to the lungs. This range is appropriate for manual ventilation to prevent high airway pressures that could lead to lung injury.&lt;/p&gt;\n&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;, &quot;bot&quot;: &quot;@futuredoctor&quot;, &quot;video&quot;: &quot;&quot;}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error(&quot;Questions data is empty or invalid&quot;);
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error(&quot;Failed to parse questions_json:&quot;, e);
            document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error loading quiz data. Please check the console for details or contact support.&quot;;
            document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            document.getElementById(&#x27;start-test&#x27;).disabled = true;
            // Fallback to sample questions for testing
            questions = [
                {
                    text: &quot;What is 2 + 2?&quot;,
                    options: [
                        { label: &quot;A&quot;, text: &quot;3&quot;, correct: false },
                        { label: &quot;B&quot;, text: &quot;4&quot;, correct: true },
                        { label: &quot;C&quot;, text: &quot;5&quot;, correct: false },
                        { label: &quot;D&quot;, text: &quot;6&quot;, correct: false }
                    ],
                    correct_answer: &quot;B. 4&quot;,
                    question_images: [],
                    explanation_images: [],
                    explanation: &quot;&lt;p&gt;2 + 2 = 4&lt;/p&gt;&lt;p&gt;@futuredoctor&lt;/p&gt;&quot;,
                    bot: &quot;@futuredoctor&quot;,
                    audio: &quot;&quot;,
                    video: &quot;&quot;
                }
            ];
            debugLog(&quot;Loaded fallback questions&quot;);
        }

        // Quiz state
        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let markedForReview = new Array(questions.length).fill(false);
        let timeRemaining = 24 * 60; // Duration in seconds
        let timerInterval = null;
        const quizId = `{title.replace(/\s+/g, &#x27;_&#x27;).toLowerCase()}`; // Unique ID for local storage

        // Load saved progress
        function loadProgress() {
            try {
                debugLog(&quot;Loading progress from localStorage&quot;);
                const saved = localStorage.getItem(`quiz_${quizId}`);
                if (saved) {
                    const { savedAnswers, savedMarked, savedTime } = JSON.parse(saved);
                    answers = savedAnswers || answers;
                    markedForReview = savedMarked || markedForReview;
                    timeRemaining = savedTime !== undefined ? savedTime : timeRemaining;
                    debugLog(&quot;Progress loaded successfully&quot;);
                } else {
                    debugLog(&quot;No saved progress found&quot;);
                }
            } catch (e) {
                console.error(&quot;Error loading progress:&quot;, e);
                debugLog(&quot;Failed to load progress: &quot; + e.message);
            }
        }

        // Save progress
        function saveProgress() {
            try {
                debugLog(&quot;Saving progress to localStorage&quot;);
                localStorage.setItem(`quiz_${quizId}`, JSON.stringify({
                    savedAnswers: answers,
                    savedMarked: markedForReview,
                    savedTime: timeRemaining
                }));
                debugLog(&quot;Progress saved successfully&quot;);
            } catch (e) {
                console.error(&quot;Error saving progress:&quot;, e);
                debugLog(&quot;Failed to save progress: &quot; + e.message);
            }
        }

        // Initialize quiz
        function initQuiz() {
            try {
                debugLog(&quot;Initializing quiz&quot;);
                loadProgress();
                const startButton = document.getElementById(&#x27;start-test&#x27;);
                if (!startButton) {
                    throw new Error(&quot;Start test button not found&quot;);
                }
                startButton.addEventListener(&#x27;click&#x27;, startQuiz);
                debugLog(&quot;Start test button listener attached&quot;);
                document.getElementById(&#x27;previous-btn&#x27;).addEventListener(&#x27;click&#x27;, showPreviousQuestion);
                document.getElementById(&#x27;next-btn&#x27;).addEventListener(&#x27;click&#x27;, showNextQuestion);
                document.getElementById(&#x27;mark-review&#x27;).addEventListener(&#x27;click&#x27;, toggleMarkForReview);
                document.getElementById(&#x27;nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;submit-test&#x27;).addEventListener(&#x27;click&#x27;, showSubmitModal);
                document.getElementById(&#x27;continue-test&#x27;).addEventListener(&#x27;click&#x27;, closeExitModal);
                document.getElementById(&#x27;exit-test&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Exiting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;cancel-submit&#x27;).addEventListener(&#x27;click&#x27;, closeSubmitModal);
                document.getElementById(&#x27;confirm-submit&#x27;).addEventListener(&#x27;click&#x27;, submitTest);
                document.getElementById(&#x27;take-again&#x27;).addEventListener(&#x27;click&#x27;, () =&gt; {
                    debugLog(&quot;Restarting test&quot;);
                    localStorage.removeItem(`quiz_${quizId}`);
                    window.location.reload();
                });
                document.getElementById(&#x27;close-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleNavPanel);
                document.getElementById(&#x27;nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateNavPanel);
                document.getElementById(&#x27;prev-result&#x27;).addEventListener(&#x27;click&#x27;, showPreviousResult);
                document.getElementById(&#x27;next-result&#x27;).addEventListener(&#x27;click&#x27;, showNextResult);
                document.getElementById(&#x27;results-nav-toggle&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;close-results-nav&#x27;).addEventListener(&#x27;click&#x27;, toggleResultsNavPanel);
                document.getElementById(&#x27;results-nav-filter&#x27;).addEventListener(&#x27;change&#x27;, updateResultsNavPanel);
                debugLog(&quot;Quiz initialized successfully&quot;);
            } catch (e) {
                console.error(&quot;Failed to initialize quiz:&quot;, e);
                debugLog(&quot;Failed to initialize quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;start-test&#x27;).disabled = true;
            }
        }

        // Start quiz
        function startQuiz() {
            try {
                debugLog(&quot;Starting quiz&quot;);
                document.getElementById(&#x27;instructions&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.remove(&#x27;hidden&#x27;);
                showQuestion(currentQuestion);
                startTimer();
                updateNavPanel();
                debugLog(&quot;Quiz started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting quiz:&quot;, e);
                debugLog(&quot;Failed to start quiz: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error starting quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;instructions&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        }

        // Show question
        function showQuestion(index) {
            try {
                debugLog(`Showing question ${index + 1}`);
                currentQuestion = index;
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                document.getElementById(&#x27;question-number&#x27;).innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById(&#x27;question-text&#x27;).innerHTML = q.text || &quot;No question text available&quot;;
                const imagesDiv = document.getElementById(&#x27;question-images&#x27;);
                imagesDiv.innerHTML = q.question_images &amp;&amp; q.question_images.length &gt; 0
                    ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg&quot;&gt;`).join(&#x27;&#x27;)
                    : &#x27;&#x27;;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                optionsDiv.innerHTML = q.options &amp;&amp; q.options.length &gt; 0
                    ? q.options.map(opt =&gt; `
                        &lt;button class=&quot;option-btn w-full text-left p-3 border rounded-lg ${answers[index] === opt.label ? &#x27;selected&#x27; : &#x27;&#x27;}&quot; 
                                onclick=&quot;selectOption(${index}, &#x27;${opt.label}&#x27;)&quot; 
                                aria-label=&quot;Option ${opt.label}: ${opt.text}&quot;&gt;
                            ${opt.label}. ${opt.text}
                        &lt;/button&gt;
                    `).join(&#x27;&#x27;)
                    : &#x27;&lt;p class=&quot;text-red-500&quot;&gt;No options available&lt;/p&gt;&#x27;;
                document.getElementById(&#x27;previous-btn&#x27;).disabled = index === 0;
                document.getElementById(&#x27;next-btn&#x27;).disabled = index === questions.length - 1;
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[index]);
                updateProgressBar();
                saveProgress();
                window.scrollTo({ top: 0, behavior: &#x27;smooth&#x27; });
                debugLog(`Question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying question:&quot;, e);
                debugLog(&quot;Failed to display question: &quot; + e.message);
            }
        }


        // Select option
        function selectOption(index, label) {
            try {
                debugLog(`Selecting option ${label} for question ${index + 1}`);
                answers[index] = label;
                const optionsDiv = document.getElementById(&#x27;options&#x27;);
                const optionButtons = optionsDiv.querySelectorAll(&#x27;.option-btn&#x27;);
                optionButtons.forEach(btn =&gt; {
                    const btnLabel = btn.textContent.trim().split(&#x27;.&#x27;)[0];
                    btn.classList.toggle(&#x27;selected&#x27;, btnLabel === label);
                });
                updateNavPanel();
                saveProgress();
                debugLog(`Option ${label} selected for question ${index + 1}`);
            } catch (e) {
                console.error(&quot;Error selecting option:&quot;, e);
                debugLog(&quot;Failed to select option: &quot; + e.message);
            }
        }

        // Toggle mark for review
        function toggleMarkForReview() {
            try {
                debugLog(`Toggling mark for review on question ${currentQuestion + 1}`);
                markedForReview[currentQuestion] = !markedForReview[currentQuestion];
                document.getElementById(&#x27;mark-review&#x27;).classList.toggle(&#x27;marked&#x27;, markedForReview[currentQuestion]);
                updateNavPanel();
                saveProgress();
                debugLog(`Mark for review toggled for question ${currentQuestion + 1}`);
            } catch (e) {
                console.error(&quot;Error marking for review:&quot;, e);
                debugLog(&quot;Failed to mark for review: &quot; + e.message);
            }
        }

        // Navigate to previous question
        function showPreviousQuestion() {
            try {
                debugLog(`Navigating to previous question from ${currentQuestion + 1}`);
                if (currentQuestion &gt; 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous question:&quot;, e);
                debugLog(&quot;Failed to navigate to previous question: &quot; + e.message);
            }
        }

        // Navigate to next question
        function showNextQuestion() {
            try {
                debugLog(`Navigating to next question from ${currentQuestion + 1}`);
                if (currentQuestion &lt; questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next question:&quot;, e);
                debugLog(&quot;Failed to navigate to next question: &quot; + e.message);
            }
        }

        // Handle question navigation click
        function handleQuestionNavClick(index) {
            try {
                debugLog(`Navigating to question ${index + 1} via nav panel`);
                showQuestion(index);
                toggleNavPanel();
            } catch (e) {
                console.error(&quot;Error handling navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate via nav panel: &quot; + e.message);
            }
        }

        // Start timer
        function startTimer() {
            try {
                debugLog(&quot;Starting timer&quot;);
                timerInterval = setInterval(() =&gt; {
                    if (timeRemaining &lt;= 0) {
                        debugLog(&quot;Timer expired, submitting test&quot;);
                        clearInterval(timerInterval);
                        submitTest();
                    } else {
                        timeRemaining--;
                        const minutes = Math.floor(timeRemaining / 60);
                        const seconds = timeRemaining % 60;
                        document.getElementById(&#x27;timer&#x27;).innerHTML = `Time Remaining: &lt;span&gt;${minutes.toString().padStart(2, &#x27;0&#x27;)}:${seconds.toString().padStart(2, &#x27;0&#x27;)}&lt;/span&gt;`;
                        saveProgress();
                    }
                }, 1000);
                debugLog(&quot;Timer started successfully&quot;);
            } catch (e) {
                console.error(&quot;Error starting timer:&quot;, e);
                debugLog(&quot;Failed to start timer: &quot; + e.message);
            }
        }

        // Update progress bar
        function updateProgressBar() {
            try {
                debugLog(&quot;Updating progress bar&quot;);
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                document.getElementById(&#x27;progress-bar&#x27;).style.width = `${progress}%`;
                debugLog(&quot;Progress bar updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating progress bar:&quot;, e);
                debugLog(&quot;Failed to update progress bar: &quot; + e.message);
            }
        }

        // Update quiz navigation panel
        function updateNavPanel() {
            try {
                debugLog(&quot;Updating quiz navigation panel&quot;);
                const filter = document.getElementById(&#x27;nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;question-nav-btn ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleQuestionNavClick(${i})&quot;
                                aria-label=&quot;Go to Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Quiz navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to update quiz navigation panel: &quot; + e.message);
            }
        }

        // Update results navigation panel
        function updateResultsNavPanel() {
            try {
                debugLog(&quot;Updating results navigation panel&quot;);
                const filter = document.getElementById(&#x27;results-nav-filter&#x27;).value;
                const navGrid = document.getElementById(&#x27;results-nav-grid&#x27;);
                navGrid.innerHTML = questions.map((_, i) =&gt; {
                    if (filter === &#x27;answered&#x27; &amp;&amp; !answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;unanswered&#x27; &amp;&amp; answers[i]) return &#x27;&#x27;;
                    if (filter === &#x27;marked&#x27; &amp;&amp; !markedForReview[i]) return &#x27;&#x27;;
                    return `
                        &lt;button class=&quot;result-nav-btn-grid ${answers[i] ? &#x27;answered&#x27; : &#x27;unanswered&#x27;} ${markedForReview[i] ? &#x27;marked-nav&#x27; : &#x27;&#x27;}&quot;
                                onclick=&quot;handleResultNavClick(${i})&quot;
                                aria-label=&quot;Go to Result for Question ${i + 1}&quot;&gt;
                            ${i + 1}
                        &lt;/button&gt;
                    `;
                }).join(&#x27;&#x27;);
                debugLog(&quot;Results navigation panel updated&quot;);
            } catch (e) {
                console.error(&quot;Error updating results navigation panel:&quot;, e);
                debugLog(&quot;Failed to update results navigation panel: &quot; + e.message);
            }
        }

        // Toggle quiz navigation panel
        function toggleNavPanel() {
            try {
                debugLog(&quot;Toggling quiz navigation panel&quot;);
                const navPanel = document.getElementById(&#x27;nav-panel&#x27;);
                navPanel.classList.toggle(&#x27;hidden&#x27;);
                debugLog(&quot;Quiz navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling quiz navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle quiz navigation panel: &quot; + e.message);
            }
        }

        // Toggle results navigation panel
        function toggleResultsNavPanel() {
            try {
                debugLog(&quot;Toggling results navigation panel&quot;);
                const resultsNavPanel = document.getElementById(&#x27;results-nav-panel&#x27;);
                resultsNavPanel.classList.toggle(&#x27;hidden&#x27;);
                if (!resultsNavPanel.classList.contains(&#x27;hidden&#x27;)) {
                    updateResultsNavPanel();
                }
                debugLog(&quot;Results navigation panel toggled&quot;);
            } catch (e) {
                console.error(&quot;Error toggling results navigation panel:&quot;, e);
                debugLog(&quot;Failed to toggle results navigation panel: &quot; + e.message);
            }
        }

        // Handle result navigation click
        function handleResultNavClick(index) {
            try {
                debugLog(`Navigating to result for question ${index + 1} via nav panel`);
                showResults(index);
                toggleResultsNavPanel();
            } catch (e) {
                console.error(&quot;Error handling result navigation click:&quot;, e);
                debugLog(&quot;Failed to navigate to result: &quot; + e.message);
            }
        }

        // Show submit modal
        function showSubmitModal() {
            try {
                debugLog(&quot;Showing submit modal&quot;);
                const attempted = answers.filter(a =&gt; a !== null).length;
                document.getElementById(&#x27;attempted-count&#x27;).textContent = attempted;
                document.getElementById(&#x27;unattempted-count&#x27;).textContent = questions.length - attempted;
                document.getElementById(&#x27;submit-modal&#x27;).classList.remove(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal displayed&quot;);
            } catch (e) {
                console.error(&quot;Error showing submit modal:&quot;, e);
                debugLog(&quot;Failed to show submit modal: &quot; + e.message);
            }
        }

        // Close submit modal
        function closeSubmitModal() {
            try {
                debugLog(&quot;Closing submit modal&quot;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Submit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing submit modal:&quot;, e);
                debugLog(&quot;Failed to close submit modal: &quot; + e.message);
            }
        }

        // Close exit modal
        function closeExitModal() {
            try {
                debugLog(&quot;Closing exit modal&quot;);
                document.getElementById(&#x27;exit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                debugLog(&quot;Exit modal closed&quot;);
            } catch (e) {
                console.error(&quot;Error closing exit modal:&quot;, e);
                debugLog(&quot;Failed to close exit modal: &quot; + e.message);
            }
        }

        // Submit test
        function submitTest() {
            try {
                debugLog(&quot;Submitting test&quot;);
                clearInterval(timerInterval);
                document.getElementById(&#x27;quiz&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;submit-modal&#x27;).classList.add(&#x27;hidden&#x27;);
                document.getElementById(&#x27;results&#x27;).classList.remove(&#x27;hidden&#x27;);
                showResults(0); // Start with first question
                // Trigger confetti animation
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                localStorage.removeItem(`quiz_${quizId}`);
                debugLog(&quot;Test submitted successfully&quot;);
            } catch (e) {
                console.error(&quot;Error submitting test:&quot;, e);
                debugLog(&quot;Failed to submit test: &quot; + e.message);
            }
        }

        function showResults(index) {
            try {
                debugLog(`Showing result for question ${index + 1}`);
                currentResultQuestion = index;
                let correct = 0, wrong = 0, unanswered = 0, marked = 0;
                answers.forEach((answer, i) =&gt; {
                    const isCorrect = answer &amp;&amp; questions[i].options.find(opt =&gt; opt.label === answer)?.correct;
                    if (answer === null) unanswered++;
                    else if (isCorrect) correct++;
                    else wrong++;
                    if (markedForReview[i]) marked++;
                });
                const q = questions[index];
                if (!q) {
                    throw new Error(`Question ${index} is undefined`);
                }
                const userAnswer = answers[index];
                const isCorrect = userAnswer &amp;&amp; q.options.find(opt =&gt; opt.label === userAnswer)?.correct;
                const resultsContent = document.getElementById('results-content');
                
                // Create scrollable container for explanation content
                resultsContent.innerHTML = `
                    &lt;div class=&quot;border-4 ${isCorrect ? 'border-green-600 bg-green-100' : userAnswer ? 'border-red-600 bg-red-100' : 'border-gray-400 bg-gray-50'} p-4 rounded-lg overflow-hidden&quot;&gt;
                        &lt;p class=&quot;font-semibold&quot;&gt;Question ${index + 1}: ${q.text || 'No question text'}&lt;/p&gt;
                        ${q.question_images &amp;&amp; q.question_images.length &gt; 0 ? q.question_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Question Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        &lt;p&gt;&lt;strong&gt;Your Answer:&lt;/strong&gt; ${userAnswer ? `${userAnswer}. ${q.options.find(opt =&gt; opt.label === userAnswer)?.text || 'Invalid option'}` : 'Unanswered'}&lt;/p&gt;
                        &lt;p&gt;&lt;strong&gt;Correct Answer:&lt;/strong&gt; ${q.correct_answer || 'Unknown'}&lt;/p&gt;
                        
                        &lt;!-- Scrollable container for explanation --&gt;
                        &lt;div class=&quot;mt-2 overflow-x-auto&quot;&gt;
                            ${q.explanation || 'No explanation available'}
                        &lt;/div&gt;
                        
                        ${q.explanation_images &amp;&amp; q.explanation_images.length &gt; 0 ? q.explanation_images.map(url =&gt; `&lt;img src=&quot;${url}&quot; alt=&quot;Explanation Image&quot; class=&quot;max-w-full h-auto rounded-lg my-2&quot;&gt;`).join('') : ''}
                        ${q.video ? `
                            &lt;button class=&quot;play-video bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadVideo(this, '${q.video}', 'video-${index}')&quot;
                                    aria-label=&quot;Play explanation video for Question ${index + 1}&quot;&gt;
                                Play Video Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;video-${index}&quot; class=&quot;video-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : '&lt;p class=&quot;text-gray-500 mt-2&quot;&gt;No video available&lt;/p&gt;'}
                        ${q.audio ? `
                            &lt;button class=&quot;play-audio bg-[#2c5281] text-white px-4 py-2 rounded-lg mt-2&quot; 
                                    onclick=&quot;loadAudio(this, '${q.audio}', 'audio-${index}')&quot;
                                    aria-label=&quot;Play audio explanation for Question ${index + 1}&quot;&gt;
                                Play Audio Explanation
                            &lt;/button&gt;
                            &lt;div id=&quot;audio-${index}&quot; class=&quot;audio-container mt-2&quot;&gt;&lt;/div&gt;
                        ` : ''}
                    &lt;/div&gt;
                `;
                
                document.getElementById('correct-count').textContent = correct;
                document.getElementById('wrong-count').textContent = wrong;
                document.getElementById('unanswered-count').textContent = unanswered;
                document.getElementById('marked-count').textContent = marked;
                document.getElementById('result-question-number').innerHTML = `Question &lt;span&gt;${index + 1}&lt;/span&gt; of ${questions.length}`;
                document.getElementById('prev-result').disabled = index === 0;
                document.getElementById('next-result').disabled = index === questions.length - 1;
                updateResultsNavPanel();
                window.scrollTo({ top: 0, behavior: 'smooth' });
                debugLog(`Result for question ${index + 1} displayed successfully`);
            } catch (e) {
                console.error(&quot;Error displaying result:&quot;, e);
                debugLog(&quot;Failed to display result: &quot; + e.message);
            }
        }


        // Navigate to previous result
        function showPreviousResult() {
            try {
                debugLog(`Navigating to previous result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &gt; 0) {
                    showResults(currentResultQuestion - 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to previous result:&quot;, e);
                debugLog(&quot;Failed to navigate to previous result: &quot; + e.message);
            }
        }

        // Navigate to next result
        function showNextResult() {
            try {
                debugLog(`Navigating to next result from question ${currentResultQuestion + 1}`);
                if (currentResultQuestion &lt; questions.length - 1) {
                    showResults(currentResultQuestion + 1);
                }
            } catch (e) {
                console.error(&quot;Error navigating to next result:&quot;, e);
                debugLog(&quot;Failed to navigate to next result: &quot; + e.message);
            }
        }

        // Lazy-load video
        function loadVideo(button, videoUrl, containerId) {
            try {
                debugLog(`Loading video for ${containerId}: ${videoUrl}`);
                if (!videoUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No video available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No video URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;div class=&quot;video-loading&quot;&gt;&lt;/div&gt;
                    &lt;video controls class=&quot;w-full max-w-[600px] rounded-lg&quot; preload=&quot;metadata&quot; aria-label=&quot;Video explanation&quot;&gt;
                        &lt;source src=&quot;${videoUrl}&quot; type=&quot;${videoUrl.endsWith(&#x27;.m3u8&#x27;) ? &#x27;application/x-mpegURL&#x27; : &#x27;video/mp4&#x27;}&quot;&gt;
                        Your browser does not support the video tag.
                    &lt;/video&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Initialize HLS.js for .m3u8 videos
                const video = container.querySelector(&#x27;video&#x27;);
                if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(videoUrl);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.ERROR, (event, data) =&gt; {
                        console.error(&quot;HLS.js error:&quot;, data);
                        container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                        debugLog(&quot;HLS.js error: &quot; + JSON.stringify(data));
                    });
                } else if (videoUrl.endsWith(&#x27;.m3u8&#x27;) &amp;&amp; video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) {
                    video.src = videoUrl;
                }
                // Handle video load errors
                video.onerror = () =&gt; {
                    console.error(&quot;Video load error for URL:&quot;, videoUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Video load error for URL: &quot; + videoUrl);
                };
                // Remove loading spinner when video is ready
                video.onloadedmetadata = () =&gt; {
                    container.querySelector(&#x27;.video-loading&#x27;).remove();
                    debugLog(&quot;Video loaded successfully&quot;);
                };
            } catch (e) {
                console.error(&quot;Error loading video:&quot;, e);
                debugLog(&quot;Failed to load video: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading video. &lt;a href=&quot;${videoUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open video in new tab&quot;&gt;Open video&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Lazy-load audio
        function loadAudio(button, audioUrl, containerId) {
            try {
                debugLog(`Loading audio for ${containerId}: ${audioUrl}`);
                if (!audioUrl) {
                    const container = document.getElementById(containerId);
                    container.innerHTML = `&lt;p class=&quot;text-gray-500&quot;&gt;No audio available&lt;/p&gt;`;
                    button.remove();
                    debugLog(&quot;No audio URL provided&quot;);
                    return;
                }
                const container = document.getElementById(containerId);
                container.innerHTML = `
                    &lt;audio controls class=&quot;w-full max-w-[600px]&quot; preload=&quot;metadata&quot; aria-label=&quot;Audio explanation&quot;&gt;
                        &lt;source src=&quot;${audioUrl}&quot; type=&quot;audio/mpeg&quot;&gt;
                        Your browser does not support the audio tag.
                    &lt;/audio&gt;
                `;
                container.classList.add(&#x27;active&#x27;);
                button.remove();
                // Handle audio load errors
                const audio = container.querySelector(&#x27;audio&#x27;);
                audio.onerror = () =&gt; {
                    console.error(&quot;Audio load error for URL:&quot;, audioUrl);
                    container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
                    debugLog(&quot;Audio load error for URL: &quot; + audioUrl);
                };
                debugLog(&quot;Audio loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading audio:&quot;, e);
                debugLog(&quot;Failed to load audio: &quot; + e.message);
                const container = document.getElementById(containerId);
                container.innerHTML = `&lt;p class=&quot;text-red-500&quot;&gt;Error loading audio. &lt;a href=&quot;${audioUrl}&quot; target=&quot;_blank&quot; aria-label=&quot;Open audio in new tab&quot;&gt;Open audio&lt;/a&gt;&lt;/p&gt;`;
            }
        }

        // Toggle dark mode
        function toggleTheme() {
            try {
                debugLog(&quot;Toggling theme&quot;);
                document.documentElement.classList.toggle(&#x27;dark&#x27;);
                localStorage.setItem(&#x27;theme&#x27;, document.documentElement.classList.contains(&#x27;dark&#x27;) ? &#x27;dark&#x27; : &#x27;light&#x27;);
                debugLog(&quot;Theme toggled successfully&quot;);
            } catch (e) {
                console.error(&quot;Error toggling theme:&quot;, e);
                debugLog(&quot;Failed to toggle theme: &quot; + e.message);
            }
        }

        // Load theme preference
        function loadTheme() {
            try {
                debugLog(&quot;Loading theme preference&quot;);
                const theme = localStorage.getItem(&#x27;theme&#x27;);
                if (theme === &#x27;dark&#x27;) {
                    document.documentElement.classList.add(&#x27;dark&#x27;);
                }
                debugLog(&quot;Theme loaded successfully&quot;);
            } catch (e) {
                console.error(&quot;Error loading theme:&quot;, e);
                debugLog(&quot;Failed to load theme: &quot; + e.message);
            }
        }

        // Initialize on DOM content loaded
        window.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; {
            try {
                debugLog(&quot;DOM content loaded, initializing quiz&quot;);
                loadTheme();
                initQuiz();
            } catch (e) {
                console.error(&quot;Error during DOMContentLoaded:&quot;, e);
                debugLog(&quot;Failed to initialize on DOMContentLoaded: &quot; + e.message);
                document.getElementById(&#x27;error-message&#x27;).innerHTML = &quot;Error initializing quiz. Please check the console for details or contact support.&quot;;
                document.getElementById(&#x27;error-message&#x27;).classList.remove(&#x27;hidden&#x27;);
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;" frameborder="0" width="100%" height="2000px"></iframe>
</div>

</body>
</html>
